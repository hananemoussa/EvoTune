Finetuning score threshold: -549.2
Learning rate before schedule: 1e-05
Learning rate after schedule: 1.118033988749895e-05
Finetuning with 971 chats
Extracting prompt in train dataset: 100%|██████████| 971/971 [00:00<00:00, 4991.79 examples/s]
Applying chat template to train dataset: 100%|██████████| 971/971 [00:00<00:00, 2987.96 examples/s]
Tokenizing train dataset: 100%|██████████| 971/971 [00:03<00:00, 322.61 examples/s]
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 1}.
                                               
{'loss': 0.6931, 'grad_norm': 27.997081756591797, 'learning_rate': 1.118033988749895e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/chosen': -288.0320129394531, 'logps/rejected': -291.17474365234375, 'logits/chosen': -7.427183151245117, 'logits/rejected': -7.528543949127197, 'epoch': 0.03}
{'loss': 0.7986, 'grad_norm': 106.95631408691406, 'learning_rate': 1.117316494446355e-05, 'rewards/chosen': -0.11285571753978729, 'rewards/rejected': -0.03137493133544922, 'rewards/accuracies': 0.34375, 'rewards/margins': -0.08148077875375748, 'logps/chosen': -301.1573486328125, 'logps/rejected': -286.08331298828125, 'logits/chosen': -7.450661659240723, 'logits/rejected': -7.63026237487793, 'epoch': 0.07}
{'loss': 0.6998, 'grad_norm': 26.718746185302734, 'learning_rate': 1.1151658533333223e-05, 'rewards/chosen': 0.22060468792915344, 'rewards/rejected': 0.23591938614845276, 'rewards/accuracies': 0.46875, 'rewards/margins': -0.015314694494009018, 'logps/chosen': -288.30340576171875, 'logps/rejected': -292.0242919921875, 'logits/chosen': -7.605180263519287, 'logits/rejected': -7.618727684020996, 'epoch': 0.1}
{'loss': 0.7073, 'grad_norm': 22.459877014160156, 'learning_rate': 1.1115875860756892e-05, 'rewards/chosen': 0.5107706189155579, 'rewards/rejected': 0.46936172246932983, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.04140894114971161, 'logps/chosen': -277.51177978515625, 'logps/rejected': -302.3123779296875, 'logits/chosen': -7.458487510681152, 'logits/rejected': -7.598338603973389, 'epoch': 0.13}
{'loss': 0.6832, 'grad_norm': 8.256606101989746, 'learning_rate': 1.106590878034186e-05, 'rewards/chosen': 0.9091808795928955, 'rewards/rejected': 0.7768774032592773, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.13230344653129578, 'logps/chosen': -297.36468505859375, 'logps/rejected': -279.86590576171875, 'logits/chosen': -7.559337139129639, 'logits/rejected': -7.657246112823486, 'epoch': 0.16}
{'loss': 0.6885, 'grad_norm': 6.551437854766846, 'learning_rate': 1.1001885556866918e-05, 'rewards/chosen': 1.0029518604278564, 'rewards/rejected': 0.9134946465492249, 'rewards/accuracies': 0.46875, 'rewards/margins': 0.089457206428051, 'logps/chosen': -300.6705627441406, 'logps/rejected': -329.3453674316406, 'logits/chosen': -7.419663429260254, 'logits/rejected': -7.561214923858643, 'epoch': 0.2}
{'loss': 0.6775, 'grad_norm': 8.751663208007812, 'learning_rate': 1.0923970537028503e-05, 'rewards/chosen': 0.9412993788719177, 'rewards/rejected': 0.8376330137252808, 'rewards/accuracies': 0.5, 'rewards/margins': 0.10366645455360413, 'logps/chosen': -256.55084228515625, 'logps/rejected': -284.0697021484375, 'logits/chosen': -7.576269626617432, 'logits/rejected': -7.584907054901123, 'epoch': 0.23}
{'loss': 0.6717, 'grad_norm': 9.601093292236328, 'learning_rate': 1.0832363727565071e-05, 'rewards/chosen': 1.2764713764190674, 'rewards/rejected': 1.0867021083831787, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.18976914882659912, 'logps/chosen': -296.78955078125, 'logps/rejected': -323.50299072265625, 'logits/chosen': -7.591416358947754, 'logits/rejected': -7.568881988525391, 'epoch': 0.26}
{'loss': 0.6577, 'grad_norm': 13.834745407104492, 'learning_rate': 1.0727300281842681e-05, 'rewards/chosen': 1.1229312419891357, 'rewards/rejected': 0.8217957615852356, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.30113542079925537, 'logps/chosen': -272.1842041015625, 'logps/rejected': -306.8897399902344, 'logits/chosen': -7.549496173858643, 'logits/rejected': -7.534430980682373, 'epoch': 0.3}
{'loss': 0.7212, 'grad_norm': 136.1709747314453, 'learning_rate': 1.0609049896219671e-05, 'rewards/chosen': 0.8350068926811218, 'rewards/rejected': 0.4785394072532654, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.35646751523017883, 'logps/chosen': -270.6909484863281, 'logps/rejected': -313.53753662109375, 'logits/chosen': -7.485918045043945, 'logits/rejected': -7.678300380706787, 'epoch': 0.33}
{'loss': 0.6416, 'grad_norm': 19.784828186035156, 'learning_rate': 1.0477916117739977e-05, 'rewards/chosen': 0.7222249507904053, 'rewards/rejected': 0.5104891657829285, 'rewards/accuracies': 0.625, 'rewards/margins': 0.2117357850074768, 'logps/chosen': -247.471435546875, 'logps/rejected': -302.04156494140625, 'logits/chosen': -7.650947570800781, 'logits/rejected': -7.599395275115967, 'epoch': 0.36}
{'loss': 0.5893, 'grad_norm': 65.37174224853516, 'learning_rate': 1.0334235564932223e-05, 'rewards/chosen': 0.6211901903152466, 'rewards/rejected': -0.03735457360744476, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.6585447788238525, 'logps/chosen': -279.77685546875, 'logps/rejected': -294.92193603515625, 'logits/chosen': -7.549299716949463, 'logits/rejected': -7.621181488037109, 'epoch': 0.4}
{'loss': 0.5018, 'grad_norm': 58.95368576049805, 'learning_rate': 1.0178377063714782e-05, 'rewards/chosen': 0.5728000998497009, 'rewards/rejected': -0.07561147212982178, 'rewards/accuracies': 0.84375, 'rewards/margins': 0.6484116315841675, 'logps/chosen': -283.2448425292969, 'logps/rejected': -290.6642150878906, 'logits/chosen': -7.494511127471924, 'logits/rejected': -7.68855619430542, 'epoch': 0.43}
{'loss': 1.1945, 'grad_norm': 428.3205871582031, 'learning_rate': 1.0010740700624939e-05, 'rewards/chosen': 0.3629867136478424, 'rewards/rejected': -0.16325248777866364, 'rewards/accuracies': 0.75, 'rewards/margins': 0.5262392163276672, 'logps/chosen': -298.23065185546875, 'logps/rejected': -321.96038818359375, 'logits/chosen': -7.425394535064697, 'logits/rejected': -7.48478889465332, 'epoch': 0.46}
{'loss': 1.7189, 'grad_norm': 704.6810913085938, 'learning_rate': 9.831756795802491e-06, 'rewards/chosen': -0.02090110071003437, 'rewards/rejected': -0.5216941237449646, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.5007930397987366, 'logps/chosen': -304.00347900390625, 'logps/rejected': -303.8874816894531, 'logits/chosen': -7.3973565101623535, 'logits/rejected': -7.608158111572266, 'epoch': 0.49}
{'loss': 0.6666, 'grad_norm': 223.84754943847656, 'learning_rate': 9.64188479836411e-06, 'rewards/chosen': 0.44581881165504456, 'rewards/rejected': -0.5424288511276245, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.9882476329803467, 'logps/chosen': -281.0325622558594, 'logps/rejected': -308.7829284667969, 'logits/chosen': -7.457455158233643, 'logits/rejected': -7.502997398376465, 'epoch': 0.53}
{'loss': 0.4053, 'grad_norm': 32.91682815551758, 'learning_rate': 9.441612107004055e-06, 'rewards/chosen': 0.5375874042510986, 'rewards/rejected': -0.23296841979026794, 'rewards/accuracies': 0.84375, 'rewards/margins': 0.7705557942390442, 'logps/chosen': -279.0045471191406, 'logps/rejected': -279.519287109375, 'logits/chosen': -7.554100036621094, 'logits/rejected': -7.487142086029053, 'epoch': 0.56}
{'loss': 0.7879, 'grad_norm': 257.2816467285156, 'learning_rate': 9.231452818848717e-06, 'rewards/chosen': 0.09054554998874664, 'rewards/rejected': -0.4687563478946686, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.5593018531799316, 'logps/chosen': -261.0235900878906, 'logps/rejected': -302.888671875, 'logits/chosen': -7.574616432189941, 'logits/rejected': -7.595311641693115, 'epoch': 0.59}
{'loss': 0.9572, 'grad_norm': 383.0162048339844, 'learning_rate': 9.01194640977666e-06, 'rewards/chosen': 0.38436394929885864, 'rewards/rejected': -0.29049089550971985, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.6748548746109009, 'logps/chosen': -289.7812194824219, 'logps/rejected': -308.63665771484375, 'logits/chosen': -7.515174865722656, 'logits/rejected': -7.50752067565918, 'epoch': 0.63}
{'loss': 0.6929, 'grad_norm': 200.91046142578125, 'learning_rate': 8.783656349591793e-06, 'rewards/chosen': 0.13368619978427887, 'rewards/rejected': -0.603488564491272, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7371748089790344, 'logps/chosen': -282.06671142578125, 'logps/rejected': -275.2647705078125, 'logits/chosen': -7.582968711853027, 'logits/rejected': -7.781149387359619, 'epoch': 0.66}
{'loss': 0.3835, 'grad_norm': 35.8800048828125, 'learning_rate': 8.547168655604447e-06, 'rewards/chosen': 0.5976649522781372, 'rewards/rejected': -0.33549875020980835, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.9331637620925903, 'logps/chosen': -277.814208984375, 'logps/rejected': -293.7055358886719, 'logits/chosen': -7.493390083312988, 'logits/rejected': -7.555087566375732, 'epoch': 0.69}
{'loss': 0.5869, 'grad_norm': 180.7644500732422, 'learning_rate': 8.30309038833336e-06, 'rewards/chosen': 0.7610545754432678, 'rewards/rejected': -0.347744882106781, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.1087994575500488, 'logps/chosen': -236.19175720214844, 'logps/rejected': -318.4413146972656, 'logits/chosen': -7.546675205230713, 'logits/rejected': -7.5157976150512695, 'epoch': 0.73}
{'loss': 0.3608, 'grad_norm': 17.835302352905273, 'learning_rate': 8.052048093190014e-06, 'rewards/chosen': 0.6319375038146973, 'rewards/rejected': -0.27866503596305847, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9106025099754333, 'logps/chosen': -250.73211669921875, 'logps/rejected': -270.5233459472656, 'logits/chosen': -7.660853385925293, 'logits/rejected': -7.66477632522583, 'epoch': 0.76}
{'loss': 0.4377, 'grad_norm': 64.69584655761719, 'learning_rate': 7.794686192145572e-06, 'rewards/chosen': 0.7510482668876648, 'rewards/rejected': -0.35072749853134155, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.1017757654190063, 'logps/chosen': -257.2976379394531, 'logps/rejected': -278.2980651855469, 'logits/chosen': -7.6759138107299805, 'logits/rejected': -7.728392124176025, 'epoch': 0.79}
{'loss': 0.4078, 'grad_norm': 25.17214584350586, 'learning_rate': 7.531665329508901e-06, 'rewards/chosen': 0.7903465628623962, 'rewards/rejected': -0.21764804422855377, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.0079946517944336, 'logps/chosen': -259.4830627441406, 'logps/rejected': -301.7796936035156, 'logits/chosen': -7.521149635314941, 'logits/rejected': -7.622754096984863, 'epoch': 0.82}
{'loss': 0.3848, 'grad_norm': 35.32640838623047, 'learning_rate': 7.26366067606212e-06, 'rewards/chosen': 1.0660295486450195, 'rewards/rejected': -0.25756052136421204, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3235900402069092, 'logps/chosen': -285.33349609375, 'logps/rejected': -314.1344909667969, 'logits/chosen': -7.566009044647217, 'logits/rejected': -7.525113105773926, 'epoch': 0.86}
{'loss': 0.5615, 'grad_norm': 97.05936431884766, 'learning_rate': 6.991360195906871e-06, 'rewards/chosen': 0.36877167224884033, 'rewards/rejected': -0.2365121841430664, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.6052838563919067, 'logps/chosen': -270.1381530761719, 'logps/rejected': -314.73834228515625, 'logits/chosen': -7.477554798126221, 'logits/rejected': -7.485790252685547, 'epoch': 0.89}
{'loss': 1.7639, 'grad_norm': 2353.759765625, 'learning_rate': 6.715462880470353e-06, 'rewards/chosen': 0.7169967293739319, 'rewards/rejected': -0.11012053489685059, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.8271172642707825, 'logps/chosen': -288.450927734375, 'logps/rejected': -288.2798156738281, 'logits/chosen': -7.434714317321777, 'logits/rejected': -7.70851469039917, 'epoch': 0.92}
{'loss': 0.6114, 'grad_norm': 328.6729431152344, 'learning_rate': 6.436676954204343e-06, 'rewards/chosen': 0.5380015969276428, 'rewards/rejected': -0.5054932236671448, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.0434949398040771, 'logps/chosen': -309.94012451171875, 'logps/rejected': -331.06781005859375, 'logits/chosen': -7.564140319824219, 'logits/rejected': -7.561865329742432, 'epoch': 0.96}
{'loss': 0.513, 'grad_norm': 79.6074447631836, 'learning_rate': 6.155718056583188e-06, 'rewards/chosen': 0.6330861449241638, 'rewards/rejected': -0.3659117817878723, 'rewards/accuracies': 0.75, 'rewards/margins': 0.9989979267120361, 'logps/chosen': -304.3392028808594, 'logps/rejected': -312.3424987792969, 'logits/chosen': -7.6089396476745605, 'logits/rejected': -7.649758815765381, 'epoch': 0.99}
{'loss': 0.4912, 'grad_norm': 29.476581573486328, 'learning_rate': 5.87330740506754e-06, 'rewards/chosen': 0.8467465043067932, 'rewards/rejected': -0.11496136337518692, 'rewards/accuracies': 0.7272727489471436, 'rewards/margins': 0.9617080092430115, 'logps/chosen': -232.11630249023438, 'logps/rejected': -280.0671081542969, 'logits/chosen': -7.788386344909668, 'logits/rejected': -7.7233500480651855, 'epoch': 1.0}
{'loss': 0.4156, 'grad_norm': 38.36341857910156, 'learning_rate': 5.590169943749475e-06, 'rewards/chosen': 0.8591090440750122, 'rewards/rejected': -0.300136923789978, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.1592460870742798, 'logps/chosen': -275.9007568359375, 'logps/rejected': -259.0957946777344, 'logits/chosen': -7.555705547332764, 'logits/rejected': -7.588255882263184, 'epoch': 1.03}
{'loss': 0.3034, 'grad_norm': 40.92137145996094, 'learning_rate': 5.307032482431412e-06, 'rewards/chosen': 0.9347109794616699, 'rewards/rejected': -0.674319326877594, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.6090302467346191, 'logps/chosen': -285.99114990234375, 'logps/rejected': -277.24420166015625, 'logits/chosen': -7.547440528869629, 'logits/rejected': -7.542101860046387, 'epoch': 1.07}
{'loss': 0.282, 'grad_norm': 28.982765197753906, 'learning_rate': 5.024621830915764e-06, 'rewards/chosen': 0.9590334296226501, 'rewards/rejected': -0.6034453511238098, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.56247878074646, 'logps/chosen': -262.2283935546875, 'logps/rejected': -319.799072265625, 'logits/chosen': -7.510418891906738, 'logits/rejected': -7.546293258666992, 'epoch': 1.1}
{'loss': 0.2857, 'grad_norm': 32.65220642089844, 'learning_rate': 4.743662933294609e-06, 'rewards/chosen': 0.9926532506942749, 'rewards/rejected': -0.5242316722869873, 'rewards/accuracies': 1.0, 'rewards/margins': 1.5168848037719727, 'logps/chosen': -264.3929748535156, 'logps/rejected': -279.5948791503906, 'logits/chosen': -7.607115268707275, 'logits/rejected': -7.634632587432861, 'epoch': 1.13}
{'loss': 0.3116, 'grad_norm': 86.98406219482422, 'learning_rate': 4.464877007028597e-06, 'rewards/chosen': 0.8841296434402466, 'rewards/rejected': -0.7959446907043457, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.6800744533538818, 'logps/chosen': -272.0743713378906, 'logps/rejected': -312.6910400390625, 'logits/chosen': -7.524156093597412, 'logits/rejected': -7.622365951538086, 'epoch': 1.16}
{'loss': 0.2481, 'grad_norm': 22.884166717529297, 'learning_rate': 4.18897969159208e-06, 'rewards/chosen': 0.8498075008392334, 'rewards/rejected': -0.8989521265029907, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7487595081329346, 'logps/chosen': -279.3094482421875, 'logps/rejected': -309.2459716796875, 'logits/chosen': -7.542838096618652, 'logits/rejected': -7.538561820983887, 'epoch': 1.2}
{'loss': 0.2172, 'grad_norm': 27.241249084472656, 'learning_rate': 3.916679211436831e-06, 'rewards/chosen': 0.6733646392822266, 'rewards/rejected': -0.970757007598877, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.6441216468811035, 'logps/chosen': -266.717529296875, 'logps/rejected': -312.9153137207031, 'logits/chosen': -7.469912052154541, 'logits/rejected': -7.503915786743164, 'epoch': 1.23}
{'loss': 0.4214, 'grad_norm': 102.98347473144531, 'learning_rate': 3.6486745579900496e-06, 'rewards/chosen': 0.9144463539123535, 'rewards/rejected': -0.8311930298805237, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7456395626068115, 'logps/chosen': -278.52154541015625, 'logps/rejected': -253.77081298828125, 'logits/chosen': -7.509101390838623, 'logits/rejected': -7.562146186828613, 'epoch': 1.26}
{'loss': 0.104, 'grad_norm': 23.89659881591797, 'learning_rate': 3.38565369535338e-06, 'rewards/chosen': 0.5418872833251953, 'rewards/rejected': -1.308447003364563, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.8503341674804688, 'logps/chosen': -259.8135986328125, 'logps/rejected': -272.9068603515625, 'logits/chosen': -7.6024580001831055, 'logits/rejected': -7.5987958908081055, 'epoch': 1.3}
{'loss': 0.121, 'grad_norm': 34.192405700683594, 'learning_rate': 3.1282917943089365e-06, 'rewards/chosen': 0.3058740198612213, 'rewards/rejected': -1.2202587127685547, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.526132583618164, 'logps/chosen': -283.0585632324219, 'logps/rejected': -302.82147216796875, 'logits/chosen': -7.54924201965332, 'logits/rejected': -7.677455902099609, 'epoch': 1.33}
{'loss': 0.2123, 'grad_norm': 88.10498046875, 'learning_rate': 2.877249499165593e-06, 'rewards/chosen': 0.4427403211593628, 'rewards/rejected': -1.4416289329528809, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.8843693733215332, 'logps/chosen': -292.9158935546875, 'logps/rejected': -316.0484924316406, 'logits/chosen': -7.484896659851074, 'logits/rejected': -7.56393575668335, 'epoch': 1.36}
{'loss': 0.7003, 'grad_norm': 423.1542053222656, 'learning_rate': 2.6331712318945045e-06, 'rewards/chosen': 0.33258241415023804, 'rewards/rejected': -1.5380765199661255, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.8706591129302979, 'logps/chosen': -236.26235961914062, 'logps/rejected': -313.18316650390625, 'logits/chosen': -7.576797962188721, 'logits/rejected': -7.619688987731934, 'epoch': 1.4}
{'loss': 1.2737, 'grad_norm': 556.4722290039062, 'learning_rate': 2.396683537907156e-06, 'rewards/chosen': 0.1350429207086563, 'rewards/rejected': -0.9726091623306274, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.107652187347412, 'logps/chosen': -292.7204284667969, 'logps/rejected': -326.0177307128906, 'logits/chosen': -7.45631217956543, 'logits/rejected': -7.496114253997803, 'epoch': 1.43}
{'loss': 0.7097, 'grad_norm': 379.5749206542969, 'learning_rate': 2.1683934777222894e-06, 'rewards/chosen': -0.08143159002065659, 'rewards/rejected': -1.6332813501358032, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5518497228622437, 'logps/chosen': -292.24078369140625, 'logps/rejected': -290.8936767578125, 'logits/chosen': -7.485072135925293, 'logits/rejected': -7.63966178894043, 'epoch': 1.46}
{'loss': 0.1405, 'grad_norm': 50.80304718017578, 'learning_rate': 1.948887068650235e-06, 'rewards/chosen': -0.000877082347869873, 'rewards/rejected': -1.3654628992080688, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.3645859956741333, 'logps/chosen': -252.16543579101562, 'logps/rejected': -319.52374267578125, 'logits/chosen': -7.535902500152588, 'logits/rejected': -7.605068206787109, 'epoch': 1.49}
{'loss': 0.2007, 'grad_norm': 55.706512451171875, 'learning_rate': 1.7387277804948948e-06, 'rewards/chosen': -0.0693475678563118, 'rewards/rejected': -1.5039743185043335, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.434626817703247, 'logps/chosen': -309.95458984375, 'logps/rejected': -330.2481689453125, 'logits/chosen': -7.53093147277832, 'logits/rejected': -7.5169291496276855, 'epoch': 1.53}
{'loss': 2.7786, 'grad_norm': 939.6185302734375, 'learning_rate': 1.5384550891348413e-06, 'rewards/chosen': 0.05890531837940216, 'rewards/rejected': -1.092955470085144, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.1518607139587402, 'logps/chosen': -296.42425537109375, 'logps/rejected': -295.65789794921875, 'logits/chosen': -7.5154314041137695, 'logits/rejected': -7.6719970703125, 'epoch': 1.56}
{'loss': 0.1412, 'grad_norm': 18.939388275146484, 'learning_rate': 1.3485830916964591e-06, 'rewards/chosen': 0.1826610565185547, 'rewards/rejected': -1.484605073928833, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.6672661304473877, 'logps/chosen': -303.88055419921875, 'logps/rejected': -310.7905578613281, 'logits/chosen': -7.458603858947754, 'logits/rejected': -7.613888263702393, 'epoch': 1.59}
{'loss': 0.8235, 'grad_norm': 449.2138977050781, 'learning_rate': 1.1695991868740118e-06, 'rewards/chosen': 0.0070222243666648865, 'rewards/rejected': -0.960277795791626, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.9672999978065491, 'logps/chosen': -276.1991882324219, 'logps/rejected': -292.5509948730469, 'logits/chosen': -7.5757341384887695, 'logits/rejected': -7.591733932495117, 'epoch': 1.63}
{'loss': 0.4494, 'grad_norm': 124.06146240234375, 'learning_rate': 1.001962823784171e-06, 'rewards/chosen': 0.11862516403198242, 'rewards/rejected': -1.1435437202453613, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.2621688842773438, 'logps/chosen': -256.5215148925781, 'logps/rejected': -327.3153076171875, 'logits/chosen': -7.613405227661133, 'logits/rejected': -7.553117752075195, 'epoch': 1.66}
{'loss': 0.2447, 'grad_norm': 79.66886138916016, 'learning_rate': 8.461043225667277e-07, 'rewards/chosen': 0.4377838969230652, 'rewards/rejected': -1.195285439491272, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6330692768096924, 'logps/chosen': -294.1640625, 'logps/rejected': -310.86370849609375, 'logits/chosen': -7.392711162567139, 'logits/rejected': -7.5411376953125, 'epoch': 1.69}
{'loss': 2.8968, 'grad_norm': 1757.8023681640625, 'learning_rate': 7.024237697589727e-07, 'rewards/chosen': -0.16504688560962677, 'rewards/rejected': -1.401576280593872, 'rewards/accuracies': 0.75, 'rewards/margins': 1.2365293502807617, 'logps/chosen': -304.46710205078125, 'logps/rejected': -295.92962646484375, 'logits/chosen': -7.538464069366455, 'logits/rejected': -7.628135681152344, 'epoch': 1.73}
{'loss': 0.267, 'grad_norm': 127.56090545654297, 'learning_rate': 5.712899912792793e-07, 'rewards/chosen': 0.2981523275375366, 'rewards/rejected': -1.4249900579452515, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.7231422662734985, 'logps/chosen': -303.60699462890625, 'logps/rejected': -307.7149658203125, 'logits/chosen': -7.488869667053223, 'logits/rejected': -7.560156345367432, 'epoch': 1.76}
{'loss': 0.1103, 'grad_norm': 35.959598541259766, 'learning_rate': 4.530396056562699e-07, 'rewards/chosen': 0.3735610842704773, 'rewards/rejected': -1.4491428136825562, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.8227038383483887, 'logps/chosen': -248.5374755859375, 'logps/rejected': -279.78125, 'logits/chosen': -7.657677173614502, 'logits/rejected': -7.704862594604492, 'epoch': 1.79}
{'loss': 0.2217, 'grad_norm': 201.2508087158203, 'learning_rate': 3.4797615993388084e-07, 'rewards/chosen': 0.013468310236930847, 'rewards/rejected': -1.4121859073638916, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.4256541728973389, 'logps/chosen': -309.49420166015625, 'logps/rejected': -324.65130615234375, 'logits/chosen': -7.423133850097656, 'logits/rejected': -7.552751541137695, 'epoch': 1.82}
{'loss': 0.2462, 'grad_norm': 48.31472396850586, 'learning_rate': 2.563693504704482e-07, 'rewards/chosen': 0.3120875656604767, 'rewards/rejected': -1.3954317569732666, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.7075194120407104, 'logps/chosen': -274.8367004394531, 'logps/rejected': -311.9600830078125, 'logits/chosen': -7.56142520904541, 'logits/rejected': -7.662775039672852, 'epoch': 1.86}
{'loss': 0.2015, 'grad_norm': 32.497474670410156, 'learning_rate': 1.7845433063203258e-07, 'rewards/chosen': 0.2205243706703186, 'rewards/rejected': -1.3161394596099854, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.5366638898849487, 'logps/chosen': -266.9713439941406, 'logps/rejected': -312.8459777832031, 'logits/chosen': -7.57755708694458, 'logits/rejected': -7.603391170501709, 'epoch': 1.89}
{'loss': 0.7057, 'grad_norm': 313.42071533203125, 'learning_rate': 1.1443110715709136e-07, 'rewards/chosen': 0.4437081515789032, 'rewards/rejected': -0.8861388564109802, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3298472166061401, 'logps/chosen': -300.7176818847656, 'logps/rejected': -299.13714599609375, 'logits/chosen': -7.441556930541992, 'logits/rejected': -7.601302146911621, 'epoch': 1.92}
{'loss': 0.1448, 'grad_norm': 27.245899200439453, 'learning_rate': 6.446402674205879e-08, 'rewards/chosen': 0.3552161753177643, 'rewards/rejected': -1.184306025505066, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.5395221710205078, 'logps/chosen': -288.7513427734375, 'logps/rejected': -329.69305419921875, 'logits/chosen': -7.536704063415527, 'logits/rejected': -7.514000415802002, 'epoch': 1.96}
{'loss': 0.1386, 'grad_norm': 21.78997230529785, 'learning_rate': 2.868135416572621e-08, 'rewards/chosen': 0.203766867518425, 'rewards/rejected': -1.336456298828125, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.540223240852356, 'logps/chosen': -282.1198425292969, 'logps/rejected': -314.86474609375, 'logits/chosen': -7.525973320007324, 'logits/rejected': -7.640262126922607, 'epoch': 1.99}
{'loss': 0.2388, 'grad_norm': 31.560815811157227, 'learning_rate': 7.174943035398855e-09, 'rewards/chosen': 0.4194977581501007, 'rewards/rejected': -1.069136619567871, 'rewards/accuracies': 0.8181818127632141, 'rewards/margins': 1.488634467124939, 'logps/chosen': -228.37078857421875, 'logps/rejected': -273.6840515136719, 'logits/chosen': -7.807799816131592, 'logits/rejected': -7.713866710662842, 'epoch': 2.0}
{'train_runtime': 1195.1133, 'train_samples_per_second': 1.625, 'train_steps_per_second': 0.052, 'train_loss': 0.6002151324383674, 'epoch': 2.0}
Unloading and merging model: 100%|██████████| 632/632 [00:00<00:00, 6705.79it/s]
