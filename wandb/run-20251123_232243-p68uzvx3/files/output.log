[INFO] Running with config:
cluster:
  scratch_path: $PFSDIR
  use_tgi: 0
  use_vllm: 1
task:
  task_name: bin
  function_str_to_extract: priority
  Weibull: 0
  OR: 1
  init_best_fit: 1
  failed_score: -20000
  timeout_period: 60
  mem_limit_gb: 10
  programdatabaseConfig:
    temp: 40.0
  initial_percentile: 0.3
model:
  model_name: llama32
  temperature: 0.9
  topk: 100
  topp: 0.95
  max_tokens: 2048
train:
  train_method_name: dpo
  finetuning_frequency: 400
  dpo_strategy: 2
  dpo_config:
    beta: 0.4
    max_seq_length: 4096
    per_device_train_batch_size: 1
    gradient_accumulation_steps: 32
    gradient_checkpointing: 1
    num_train_epochs: 2
    learning_rate: 1.0e-05
    lr_scheduler_type: cosine
    weight_decay: 0.001
    warmup_steps: 0
    logging_steps: 1
    f_divergence_type: alpha_divergence
    f_alpha_divergence_coef: 1.0
multiple_models: 0
creative_prompt: 1
descending_order: 1
gpu_nums: 0
flash_attn: 0
programdatabaseConfig:
  functions_per_prompt: 2
  num_islands: 6
  temp_sampling_flag: 1
  temp: 40.0
initial_percentile: 0.6
final_percentile: 0.2
num_cont_rounds: 5
num_outputs_per_prompt: 8
num_workers: 12
num_rounds: 20
finetuning_frequency: 10
lr_annealing: 0
one_tuning: 0
percentile: 70
max_loops: 5
accelerate_config: 1gpu_0
lora_config:
  r: 64
  lora_alpha: 32
eval_frequency: 100
evalset: trainperturbedset
testset: testset
top_k_functions_for_test: 50
function_str_to_extract: priority
wandb_name: evotune_llama_1B_test/bin_llama32_dpo_0
group_name: evotune_llama_1B_test/bin_llama32_dpo
logs_path: .
logs_dir: out/logs/evotune_llama_1B_test/bin_bin_llama32_dpo_0
wandb: 1
project: evotune-reproducing
entity: hananenmoussa
seed: 0
run_identifier_name: bin_llama32_dpo
prefix: evotune_llama_1B_test
run_or_dev: run
use_tgi: 0
use_vllm: 1
full_accelerate_config: ./configs/accelerate_config/1gpu_0.yaml
full_model_name: meta-llama/Llama-3.2-1B-Instruct
model_dtype: bfloat16
model_adapter_dir: out/logs/evotune_llama_1B_test/bin_bin_llama32_dpo_0/model_adapter_llama32
default_wandb_name: p68uzvx3
2025-11-23 23:22:44,188 - INFO - Running with config:
cluster:
  scratch_path: $PFSDIR
  use_tgi: 0
  use_vllm: 1
task:
  task_name: bin
  function_str_to_extract: priority
  Weibull: 0
  OR: 1
  init_best_fit: 1
  failed_score: -20000
  timeout_period: 60
  mem_limit_gb: 10
  programdatabaseConfig:
    temp: 40.0
  initial_percentile: 0.3
model:
  model_name: llama32
  temperature: 0.9
  topk: 100
  topp: 0.95
  max_tokens: 2048
train:
  train_method_name: dpo
  finetuning_frequency: 400
  dpo_strategy: 2
  dpo_config:
    beta: 0.4
    max_seq_length: 4096
    per_device_train_batch_size: 1
    gradient_accumulation_steps: 32
    gradient_checkpointing: 1
    num_train_epochs: 2
    learning_rate: 1.0e-05
    lr_scheduler_type: cosine
    weight_decay: 0.001
    warmup_steps: 0
    logging_steps: 1
    f_divergence_type: alpha_divergence
    f_alpha_divergence_coef: 1.0
multiple_models: 0
creative_prompt: 1
descending_order: 1
gpu_nums: 0
flash_attn: 0
programdatabaseConfig:
  functions_per_prompt: 2
  num_islands: 6
  temp_sampling_flag: 1
  temp: 40.0
initial_percentile: 0.6
final_percentile: 0.2
num_cont_rounds: 5
num_outputs_per_prompt: 8
num_workers: 12
num_rounds: 20
finetuning_frequency: 10
lr_annealing: 0
one_tuning: 0
percentile: 70
max_loops: 5
accelerate_config: 1gpu_0
lora_config:
  r: 64
  lora_alpha: 32
eval_frequency: 100
evalset: trainperturbedset
testset: testset
top_k_functions_for_test: 50
function_str_to_extract: priority
wandb_name: evotune_llama_1B_test/bin_llama32_dpo_0
group_name: evotune_llama_1B_test/bin_llama32_dpo
logs_path: .
logs_dir: out/logs/evotune_llama_1B_test/bin_bin_llama32_dpo_0
wandb: 1
project: evotune-reproducing
entity: hananenmoussa
seed: 0
run_identifier_name: bin_llama32_dpo
prefix: evotune_llama_1B_test
run_or_dev: run
use_tgi: 0
use_vllm: 1
full_accelerate_config: ./configs/accelerate_config/1gpu_0.yaml
full_model_name: meta-llama/Llama-3.2-1B-Instruct
model_dtype: bfloat16
model_adapter_dir: out/logs/evotune_llama_1B_test/bin_bin_llama32_dpo_0/model_adapter_llama32
default_wandb_name: p68uzvx3

[INFO] Resuming from logs directory

2025-11-23 23:22:44,195 - INFO - Resuming from logs directory
[INFO] Total functions evaluated: 80
2025-11-23 23:22:44,246 - INFO - Total functions evaluated: 80
[INFO] Number of functions in the programbank: 30
2025-11-23 23:22:44,246 - INFO - Number of functions in the programbank: 30
[INFO] Number of functions in the finetuning data: 62
2025-11-23 23:22:44,247 - INFO - Number of functions in the finetuning data: 62
[INFO] Flag load finetuned: False
2025-11-23 23:22:44,248 - INFO - Flag load finetuned: False
[INFO] ====================== Inference Engine: vLLM ======================
2025-11-23 23:22:44,250 - INFO - ====================== Inference Engine: vLLM ======================
[INFO] Starting with round number 10
2025-11-23 23:22:44,250 - INFO - Starting with round number 10
[INFO] STARTING ROUND NUM: 10
2025-11-23 23:22:44,251 - INFO - STARTING ROUND NUM: 10
[INFO] Prompt num: 15
2025-11-23 23:22:44,251 - INFO - Prompt num: 15
[INFO] Total functions generated so far: 120
2025-11-23 23:22:44,252 - INFO - Total functions generated so far: 120
[INFO] Total functions evaluated so far: 80
2025-11-23 23:22:44,253 - INFO - Total functions evaluated so far: 80
[INFO] Number of functions in the programbank: 30
2025-11-23 23:22:44,253 - INFO - Number of functions in the programbank: 30
[INFO] Number of datatpoints in DPO data: 62
2025-11-23 23:22:44,254 - INFO - Number of datatpoints in DPO data: 62
[INFO] Best overall program score: -536.78
2025-11-23 23:22:44,254 - INFO - Best overall program score: -536.78
[INFO] Best running_dict score: -inf
2025-11-23 23:22:44,255 - INFO - Best running_dict score: -inf
[INFO] Best running_dict best_true_score_from_score: -inf
2025-11-23 23:22:44,255 - INFO - Best running_dict best_true_score_from_score: -inf
[INFO] Starting vLLM model server...
2025-11-23 23:22:44,257 - INFO - Starting vLLM model server...
[INFO] Starting vLLM server for model meta-llama/Llama-3.2-1B-Instruct on GPU 0 at port 8080
2025-11-23 23:22:44,257 - INFO - Starting vLLM server for model meta-llama/Llama-3.2-1B-Instruct on GPU 0 at port 8080
[INFO] Waiting for all servers to start... Server PIDs: [1556650]
2025-11-23 23:22:44,260 - INFO - Waiting for all servers to start... Server PIDs: [1556650]
[INFO] Server is ready at port 8080. Serving meta-llama/Llama-3.2-1B-Instruct.
2025-11-23 23:23:20,000 - INFO - Server is ready at port 8080. Serving meta-llama/Llama-3.2-1B-Instruct.
[INFO] ----------
2025-11-23 23:23:20,001 - INFO - ----------
[INFO] GENERATING PROMPTS
2025-11-23 23:23:20,001 - INFO - GENERATING PROMPTS
/users/PAA0201/hananemoussa/.conda/envs/evotune/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
[INFO] ----------
2025-11-23 23:23:20,032 - INFO - ----------
[INFO] STARTING CONSUMERS
2025-11-23 23:23:20,033 - INFO - STARTING CONSUMERS
[INFO] ----------
2025-11-23 23:23:20,171 - INFO - ----------
[INFO] STARTING THE PRODUCER
2025-11-23 23:23:20,178 - INFO - STARTING THE PRODUCER
[INFO]
2025-11-23 23:23:20,184 - INFO -


[INFO] Prompt scores: [-574.06, -536.78]


2025-11-23 23:23:20,185 - INFO - Prompt scores: [-574.06, -536.78]
[INFO] Island id 4
2025-11-23 23:23:20,185 - INFO - Island id 4
[INFO]
2025-11-23 23:23:20,186 - INFO -


[INFO] Time taken for LLM generation: 4 seconds


2025-11-23 23:23:24,488 - INFO - Time taken for LLM generation: 4 seconds
[INFO] Function priority not found in the extracted function.
2025-11-23 23:23:24,490 - INFO - Function priority not found in the extracted function.
[INFO] Function priority not found in the extracted function.
2025-11-23 23:23:24,490 - INFO - Function priority not found in the extracted function.
[INFO] Number of outputs with at least one valid function definition: 6
2025-11-23 23:23:24,491 - INFO - Number of outputs with at least one valid function definition: 6
[INFO] LLM generation time: 4
2025-11-23 23:23:24,494 - INFO - LLM generation time: 4
[INFO] Producer: Generated 6 functions for prompt 16
2025-11-23 23:23:24,495 - INFO - Producer: Generated 6 functions for prompt 16
[INFO] Producer: Generated 2 failed functions for prompt 16
2025-11-23 23:23:24,496 - INFO - Producer: Generated 2 failed functions for prompt 16
[INFO]
2025-11-23 23:23:24,497 - INFO -


[INFO] Prompt scores: [-574.06, -536.78]


2025-11-23 23:23:24,497 - INFO - Prompt scores: [-574.06, -536.78]
[INFO] Island id 3
2025-11-23 23:23:24,497 - INFO - Island id 3
[INFO]
2025-11-23 23:23:24,497 - INFO -


[INFO] Time taken for LLM generation: 6 seconds


2025-11-23 23:23:30,766 - INFO - Time taken for LLM generation: 6 seconds
[INFO] Number of outputs with at least one valid function definition: 8
2025-11-23 23:23:30,767 - INFO - Number of outputs with at least one valid function definition: 8
[INFO] LLM generation time: 6
2025-11-23 23:23:30,770 - INFO - LLM generation time: 6
[INFO] Producer: Generated 8 functions for prompt 17
2025-11-23 23:23:30,770 - INFO - Producer: Generated 8 functions for prompt 17
[INFO] Producer: Generated 0 failed functions for prompt 17
2025-11-23 23:23:30,771 - INFO - Producer: Generated 0 failed functions for prompt 17
[INFO]
2025-11-23 23:23:30,771 - INFO -


[INFO] Prompt scores: [-574.06, -536.78]


2025-11-23 23:23:30,772 - INFO - Prompt scores: [-574.06, -536.78]
[INFO] Island id 0
2025-11-23 23:23:30,772 - INFO - Island id 0
[INFO]
2025-11-23 23:23:30,772 - INFO -


[INFO] Time taken for LLM generation: 12 seconds


2025-11-23 23:23:43,228 - INFO - Time taken for LLM generation: 12 seconds
[INFO] Function priority not found in the extracted function.
2025-11-23 23:23:43,228 - INFO - Function priority not found in the extracted function.
[INFO] Number of outputs with at least one valid function definition: 7
2025-11-23 23:23:43,230 - INFO - Number of outputs with at least one valid function definition: 7
[INFO] LLM generation time: 12
2025-11-23 23:23:43,232 - INFO - LLM generation time: 12
[INFO] Producer: Generated 7 functions for prompt 18
2025-11-23 23:23:43,233 - INFO - Producer: Generated 7 functions for prompt 18
[INFO] Producer: Generated 1 failed functions for prompt 18
2025-11-23 23:23:43,261 - INFO - Producer: Generated 1 failed functions for prompt 18
[INFO]
2025-11-23 23:23:43,262 - INFO -


[INFO] Prompt scores: [-606.36, -574.06]


2025-11-23 23:23:43,262 - INFO - Prompt scores: [-606.36, -574.06]
[INFO] Island id 0
2025-11-23 23:23:43,262 - INFO - Island id 0
[INFO]
2025-11-23 23:23:43,262 - INFO -


[INFO] Time taken for LLM generation: 5 seconds


2025-11-23 23:23:48,820 - INFO - Time taken for LLM generation: 5 seconds
[INFO] Number of outputs with at least one valid function definition: 8
2025-11-23 23:23:48,822 - INFO - Number of outputs with at least one valid function definition: 8
[INFO] LLM generation time: 5
2025-11-23 23:23:48,825 - INFO - LLM generation time: 5
[INFO] Producer: Generated 8 functions for prompt 19
2025-11-23 23:23:48,825 - INFO - Producer: Generated 8 functions for prompt 19
[INFO] Producer: Generated 0 failed functions for prompt 19
2025-11-23 23:23:48,825 - INFO - Producer: Generated 0 failed functions for prompt 19
[INFO]
2025-11-23 23:23:48,826 - INFO -


[INFO] Prompt scores: [-574.06, -536.78]


2025-11-23 23:23:48,826 - INFO - Prompt scores: [-574.06, -536.78]
[INFO] Island id 3
2025-11-23 23:23:48,826 - INFO - Island id 3
[INFO]
2025-11-23 23:23:48,826 - INFO -


[INFO] Time taken for LLM generation: 11 seconds


2025-11-23 23:24:00,150 - INFO - Time taken for LLM generation: 11 seconds
[INFO] Function priority not found in the extracted function.
2025-11-23 23:24:00,151 - INFO - Function priority not found in the extracted function.
[INFO] Function priority not found in the extracted function.
2025-11-23 23:24:00,151 - INFO - Function priority not found in the extracted function.
[INFO] Function priority not found in the extracted function.
2025-11-23 23:24:00,151 - INFO - Function priority not found in the extracted function.
[INFO] Function priority not found in the extracted function.
2025-11-23 23:24:00,152 - INFO - Function priority not found in the extracted function.
[INFO] Number of outputs with at least one valid function definition: 4
2025-11-23 23:24:00,152 - INFO - Number of outputs with at least one valid function definition: 4
[INFO] LLM generation time: 11
2025-11-23 23:24:00,161 - INFO - LLM generation time: 11
[INFO] Producer: Generated 4 functions for prompt 20
2025-11-23 23:24:00,161 - INFO - Producer: Generated 4 functions for prompt 20
[INFO] Producer: Generated 4 failed functions for prompt 20
2025-11-23 23:24:00,177 - INFO - Producer: Generated 4 failed functions for prompt 20
[INFO] Producer: Sent stopping signals to consumers
2025-11-23 23:24:00,177 - INFO - Producer: Sent stopping signals to consumers
[INFO] WAITING FOR CONSUMERS TO FINISH
2025-11-23 23:24:00,177 - INFO - WAITING FOR CONSUMERS TO FINISH
[INFO] Waiting for consumer process 1556805, worker id 0 to finish
2025-11-23 23:24:00,177 - INFO - Waiting for consumer process 1556805, worker id 0 to finish
[INFO] Queue size: 12, timeout time: 240
2025-11-23 23:24:00,178 - INFO - Queue size: 12, timeout time: 240
[INFO] Consumer process 1556805 exited
2025-11-23 23:24:04,243 - INFO - Consumer process 1556805 exited
[INFO] Waiting for consumer process 1556806, worker id 1 to finish
2025-11-23 23:24:04,244 - INFO - Waiting for consumer process 1556806, worker id 1 to finish
[INFO] Queue size: 3, timeout time: 120
2025-11-23 23:24:04,244 - INFO - Queue size: 3, timeout time: 120
[INFO] Consumer process 1556806 exited
2025-11-23 23:24:04,797 - INFO - Consumer process 1556806 exited
[INFO] Waiting for consumer process 1556807, worker id 2 to finish
2025-11-23 23:24:04,797 - INFO - Waiting for consumer process 1556807, worker id 2 to finish
[INFO] Queue size: 3, timeout time: 120
2025-11-23 23:24:04,797 - INFO - Queue size: 3, timeout time: 120
[INFO] Consumer process 1556807 exited
2025-11-23 23:24:22,285 - INFO - Consumer process 1556807 exited
[INFO] Waiting for consumer process 1556811, worker id 3 to finish
2025-11-23 23:24:22,285 - INFO - Waiting for consumer process 1556811, worker id 3 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,286 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556811 exited
2025-11-23 23:24:22,286 - INFO - Consumer process 1556811 exited
[INFO] Waiting for consumer process 1556814, worker id 4 to finish
2025-11-23 23:24:22,286 - INFO - Waiting for consumer process 1556814, worker id 4 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,286 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556814 exited
2025-11-23 23:24:22,287 - INFO - Consumer process 1556814 exited
[INFO] Waiting for consumer process 1556816, worker id 5 to finish
2025-11-23 23:24:22,287 - INFO - Waiting for consumer process 1556816, worker id 5 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,287 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556816 exited
2025-11-23 23:24:22,287 - INFO - Consumer process 1556816 exited
[INFO] Waiting for consumer process 1556820, worker id 6 to finish
2025-11-23 23:24:22,287 - INFO - Waiting for consumer process 1556820, worker id 6 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,288 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556820 exited
2025-11-23 23:24:22,288 - INFO - Consumer process 1556820 exited
[INFO] Waiting for consumer process 1556822, worker id 7 to finish
2025-11-23 23:24:22,288 - INFO - Waiting for consumer process 1556822, worker id 7 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,288 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556822 exited
2025-11-23 23:24:22,289 - INFO - Consumer process 1556822 exited
[INFO] Waiting for consumer process 1556826, worker id 8 to finish
2025-11-23 23:24:22,289 - INFO - Waiting for consumer process 1556826, worker id 8 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,289 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556826 exited
2025-11-23 23:24:22,289 - INFO - Consumer process 1556826 exited
[INFO] Waiting for consumer process 1556828, worker id 9 to finish
2025-11-23 23:24:22,289 - INFO - Waiting for consumer process 1556828, worker id 9 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,290 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556828 exited
2025-11-23 23:24:22,290 - INFO - Consumer process 1556828 exited
[INFO] Waiting for consumer process 1556831, worker id 10 to finish
2025-11-23 23:24:22,290 - INFO - Waiting for consumer process 1556831, worker id 10 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,290 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556831 exited
2025-11-23 23:24:22,291 - INFO - Consumer process 1556831 exited
[INFO] Waiting for consumer process 1556832, worker id 11 to finish
2025-11-23 23:24:22,291 - INFO - Waiting for consumer process 1556832, worker id 11 to finish
[INFO] Queue size: 0, timeout time: 120
2025-11-23 23:24:22,291 - INFO - Queue size: 0, timeout time: 120
[INFO] Consumer process 1556832 exited
2025-11-23 23:24:22,291 - INFO - Consumer process 1556832 exited
[INFO] ###################
2025-11-23 23:24:22,304 - INFO - ###################
[INFO] Num of passed functions: 13
2025-11-23 23:24:22,305 - INFO - Num of passed functions: 13
[INFO] Num of failed functions: 27
2025-11-23 23:24:22,305 - INFO - Num of failed functions: 27
[INFO] ###################
2025-11-23 23:24:22,306 - INFO - ###################
[INFO] Finished with continuous sampling and evaluation for 5 rounds
2025-11-23 23:24:22,339 - INFO - Finished with continuous sampling and evaluation for 5 rounds
[INFO] Killing model server, preparing for finetuning...
2025-11-23 23:24:22,340 - INFO - Killing model server, preparing for finetuning...
[INFO] Server process 1556650 has terminated successfully.
2025-11-23 23:24:23,643 - INFO - Server process 1556650 has terminated successfully.
[INFO] ----------
2025-11-23 23:24:23,643 - INFO - ----------
[INFO] TRAINING MODEL AT ROUND NUM: 10
2025-11-23 23:24:23,644 - INFO - TRAINING MODEL AT ROUND NUM: 10
