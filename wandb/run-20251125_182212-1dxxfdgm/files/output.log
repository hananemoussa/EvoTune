Finetuning score threshold: -574.06
Learning rate before schedule: 1e-05
Learning rate after schedule: 1.5811388300841898e-05
Finetuning with 733 chats
Extracting prompt in train dataset: 100%|██████████| 733/733 [00:00<00:00, 4989.30 examples/s]
Applying chat template to train dataset: 100%|██████████| 733/733 [00:00<00:00, 2909.85 examples/s]
Tokenizing train dataset: 100%|██████████| 733/733 [00:02<00:00, 331.74 examples/s]
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 1}.
                                               
{'loss': 0.6931, 'grad_norm': 29.340167999267578, 'learning_rate': 1.5811388300841898e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/chosen': -323.10064697265625, 'logps/rejected': -303.9197692871094, 'logits/chosen': -7.456223964691162, 'logits/rejected': -7.573562145233154, 'epoch': 0.04}
{'loss': 0.7676, 'grad_norm': 59.79050827026367, 'learning_rate': 1.5792958303068264e-05, 'rewards/chosen': -0.020482739433646202, 'rewards/rejected': 0.03882288932800293, 'rewards/accuracies': 0.375, 'rewards/margins': -0.059305619448423386, 'logps/chosen': -281.42474365234375, 'logps/rejected': -309.2184753417969, 'logits/chosen': -7.543318271636963, 'logits/rejected': -7.564465045928955, 'epoch': 0.09}
{'loss': 0.721, 'grad_norm': 31.077056884765625, 'learning_rate': 1.573775423890461e-05, 'rewards/chosen': 0.379484087228775, 'rewards/rejected': 0.3905704617500305, 'rewards/accuracies': 0.40625, 'rewards/margins': -0.0110863596200943, 'logps/chosen': -309.5981750488281, 'logps/rejected': -319.3382873535156, 'logits/chosen': -7.498534679412842, 'logits/rejected': -7.551211357116699, 'epoch': 0.13}
{'loss': 0.7307, 'grad_norm': 14.47822380065918, 'learning_rate': 1.564603349518132e-05, 'rewards/chosen': 0.7013082504272461, 'rewards/rejected': 0.9719655513763428, 'rewards/accuracies': 0.28125, 'rewards/margins': -0.2706572711467743, 'logps/chosen': -284.14599609375, 'logps/rejected': -307.764404296875, 'logits/chosen': -7.5160675048828125, 'logits/rejected': -7.6360087394714355, 'epoch': 0.17}
{'loss': 0.7009, 'grad_norm': 4.097716331481934, 'learning_rate': 1.5518223716345653e-05, 'rewards/chosen': 1.625030755996704, 'rewards/rejected': 1.4813997745513916, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.1436309516429901, 'logps/chosen': -299.6775817871094, 'logps/rejected': -292.2283630371094, 'logits/chosen': -7.645776748657227, 'logits/rejected': -7.6324872970581055, 'epoch': 0.22}
{'loss': 0.6878, 'grad_norm': 1.6124087572097778, 'learning_rate': 1.535492081058596e-05, 'rewards/chosen': 2.320443630218506, 'rewards/rejected': 2.090169668197632, 'rewards/accuracies': 0.625, 'rewards/margins': 0.23027393221855164, 'logps/chosen': -276.54736328125, 'logps/rejected': -311.2181701660156, 'logits/chosen': -7.6601409912109375, 'logits/rejected': -7.694567680358887, 'epoch': 0.26}
{'loss': 0.6938, 'grad_norm': 0.40754228830337524, 'learning_rate': 1.5156886171432595e-05, 'rewards/chosen': 2.7482478618621826, 'rewards/rejected': 2.6426329612731934, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.10561466217041016, 'logps/chosen': -309.38970947265625, 'logps/rejected': -350.20556640625, 'logits/chosen': -7.677581787109375, 'logits/rejected': -7.653894901275635, 'epoch': 0.31}
{'loss': 0.6751, 'grad_norm': 5.912210941314697, 'learning_rate': 1.4925043127789832e-05, 'rewards/chosen': 2.830374240875244, 'rewards/rejected': 2.6390318870544434, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.19134247303009033, 'logps/chosen': -262.6116027832031, 'logps/rejected': -311.70953369140625, 'logits/chosen': -7.653341293334961, 'logits/rejected': -7.735741138458252, 'epoch': 0.35}
{'loss': 0.6887, 'grad_norm': 2.0768446922302246, 'learning_rate': 1.4660472638950274e-05, 'rewards/chosen': 3.1326894760131836, 'rewards/rejected': 2.662748336791992, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.4699409008026123, 'logps/chosen': -284.21124267578125, 'logps/rejected': -287.98724365234375, 'logits/chosen': -7.644052505493164, 'logits/rejected': -7.756227016448975, 'epoch': 0.39}
{'loss': 0.6917, 'grad_norm': 0.5607225894927979, 'learning_rate': 1.4364408254663628e-05, 'rewards/chosen': 3.314300060272217, 'rewards/rejected': 2.9809398651123047, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.3333601951599121, 'logps/chosen': -298.54638671875, 'logps/rejected': -313.4866027832031, 'logits/chosen': -7.634814739227295, 'logits/rejected': -7.7159423828125, 'epoch': 0.44}
{'loss': 0.694, 'grad_norm': 0.6987661719322205, 'learning_rate': 1.4038230363758366e-05, 'rewards/chosen': 3.540555477142334, 'rewards/rejected': 3.266824245452881, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.27373141050338745, 'logps/chosen': -277.955322265625, 'logps/rejected': -300.18121337890625, 'logits/chosen': -7.693007946014404, 'logits/rejected': -7.7428436279296875, 'epoch': 0.48}
{'loss': 0.6915, 'grad_norm': 0.8665766716003418, 'learning_rate': 1.3683459758131769e-05, 'rewards/chosen': 3.4446728229522705, 'rewards/rejected': 3.0967135429382324, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.3479592204093933, 'logps/chosen': -274.72406005859375, 'logps/rejected': -314.1103210449219, 'logits/chosen': -7.622950077056885, 'logits/rejected': -7.74377965927124, 'epoch': 0.52}
{'loss': 0.7037, 'grad_norm': 3.2270917892456055, 'learning_rate': 1.3301750542116096e-05, 'rewards/chosen': 3.506279706954956, 'rewards/rejected': 3.0286288261413574, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4776509404182434, 'logps/chosen': -276.4831237792969, 'logps/rejected': -313.0524597167969, 'logits/chosen': -7.767348289489746, 'logits/rejected': -7.731864929199219, 'epoch': 0.57}
{'loss': 0.6702, 'grad_norm': 0.892023503780365, 'learning_rate': 1.2894882420280606e-05, 'rewards/chosen': 3.8201608657836914, 'rewards/rejected': 3.1654345989227295, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6547264456748962, 'logps/chosen': -292.9100341796875, 'logps/rejected': -306.4344482421875, 'logits/chosen': -7.702767372131348, 'logits/rejected': -7.743711471557617, 'epoch': 0.61}
{'loss': 0.6907, 'grad_norm': 5.995947360992432, 'learning_rate': 1.2464752399627324e-05, 'rewards/chosen': 3.5050745010375977, 'rewards/rejected': 3.011652708053589, 'rewards/accuracies': 0.625, 'rewards/margins': 0.4934215545654297, 'logps/chosen': -277.23089599609375, 'logps/rejected': -333.14697265625, 'logits/chosen': -7.692224502563477, 'logits/rejected': -7.679316520690918, 'epoch': 0.65}
{'loss': 0.6934, 'grad_norm': 2.794539451599121, 'learning_rate': 1.2013365944868687e-05, 'rewards/chosen': 3.2587099075317383, 'rewards/rejected': 2.6494970321655273, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6092126369476318, 'logps/chosen': -284.2074279785156, 'logps/rejected': -317.4034423828125, 'logits/chosen': -7.638706684112549, 'logits/rejected': -7.73907470703125, 'epoch': 0.7}
{'loss': 0.6843, 'grad_norm': 4.397393226623535, 'learning_rate': 1.154282762802531e-05, 'rewards/chosen': 3.0444555282592773, 'rewards/rejected': 2.422239303588867, 'rewards/accuracies': 0.625, 'rewards/margins': 0.6222161054611206, 'logps/chosen': -272.45660400390625, 'logps/rejected': -311.89947509765625, 'logits/chosen': -7.670336723327637, 'logits/rejected': -7.7430806159973145, 'epoch': 0.74}
{'loss': 85.1373, 'grad_norm': 36421.484375, 'learning_rate': 1.1055331315939712e-05, 'rewards/chosen': 2.2238876819610596, 'rewards/rejected': 1.7077090740203857, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.5161786079406738, 'logps/chosen': -244.90463256835938, 'logps/rejected': -300.984130859375, 'logits/chosen': -7.724213600158691, 'logits/rejected': -7.6655073165893555, 'epoch': 0.79}
{'loss': 0.6574, 'grad_norm': 31.069690704345703, 'learning_rate': 1.055314994145635e-05, 'rewards/chosen': 2.4496872425079346, 'rewards/rejected': 1.4204678535461426, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.0292195081710815, 'logps/chosen': -300.3025207519531, 'logps/rejected': -322.1825256347656, 'logits/chosen': -7.609960556030273, 'logits/rejected': -7.7299017906188965, 'epoch': 0.83}
{'loss': 1.1919, 'grad_norm': 579.2669067382812, 'learning_rate': 1.0038624905959494e-05, 'rewards/chosen': 1.7864190340042114, 'rewards/rejected': 0.4105550944805145, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.3758639097213745, 'logps/chosen': -306.6766052246094, 'logps/rejected': -312.1655578613281, 'logits/chosen': -7.59740686416626, 'logits/rejected': -7.686528205871582, 'epoch': 0.87}
{'loss': 0.7965, 'grad_norm': 320.07958984375, 'learning_rate': 9.514155162679125e-06, 'rewards/chosen': 1.851119041442871, 'rewards/rejected': 0.04968622699379921, 'rewards/accuracies': 0.75, 'rewards/margins': 1.801432728767395, 'logps/chosen': -308.6872863769531, 'logps/rejected': -316.85418701171875, 'logits/chosen': -7.650757312774658, 'logits/rejected': -7.7212700843811035, 'epoch': 0.92}
{'loss': 2.6184, 'grad_norm': 999.5651245117188, 'learning_rate': 8.982186031663569e-06, 'rewards/chosen': 1.6287604570388794, 'rewards/rejected': 0.6389744877815247, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.9897860884666443, 'logps/chosen': -247.46139526367188, 'logps/rejected': -278.326171875, 'logits/chosen': -7.690655708312988, 'logits/rejected': -7.715275764465332, 'epoch': 0.96}
{'loss': 0.5704, 'grad_norm': 16.05081558227539, 'learning_rate': 8.445197798568638e-06, 'rewards/chosen': 1.7892752885818481, 'rewards/rejected': 0.52005535364151, 'rewards/accuracies': 0.8275862336158752, 'rewards/margins': 1.269219994544983, 'logps/chosen': -281.49139404296875, 'logps/rejected': -313.81231689453125, 'logits/chosen': -7.589115142822266, 'logits/rejected': -7.781177043914795, 'epoch': 1.0}
{'loss': 6.7029, 'grad_norm': 2543.119140625, 'learning_rate': 7.905694150420949e-06, 'rewards/chosen': 2.1433024406433105, 'rewards/rejected': 0.7282302975654602, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.415071964263916, 'logps/chosen': -235.0298309326172, 'logps/rejected': -290.40447998046875, 'logits/chosen': -7.815096378326416, 'logits/rejected': -7.727654457092285, 'epoch': 1.04}
{'loss': 0.6092, 'grad_norm': 99.77259063720703, 'learning_rate': 7.3661905022732625e-06, 'rewards/chosen': 1.8716976642608643, 'rewards/rejected': 0.1340935230255127, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.7376043796539307, 'logps/chosen': -308.1925048828125, 'logps/rejected': -331.1065673828125, 'logits/chosen': -7.627938747406006, 'logits/rejected': -7.712900638580322, 'epoch': 1.09}
{'loss': 0.4899, 'grad_norm': 20.827552795410156, 'learning_rate': 6.829202269178331e-06, 'rewards/chosen': 1.8916878700256348, 'rewards/rejected': 0.5127897262573242, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.3788981437683105, 'logps/chosen': -274.9034423828125, 'logps/rejected': -311.28204345703125, 'logits/chosen': -7.637757778167725, 'logits/rejected': -7.640793800354004, 'epoch': 1.13}
{'loss': 0.6024, 'grad_norm': 32.199771881103516, 'learning_rate': 6.297233138162775e-06, 'rewards/chosen': 2.3050143718719482, 'rewards/rejected': 0.8271052241325378, 'rewards/accuracies': 0.875, 'rewards/margins': 1.477908968925476, 'logps/chosen': -313.0486145019531, 'logps/rejected': -335.7568054199219, 'logits/chosen': -7.589698314666748, 'logits/rejected': -7.62024450302124, 'epoch': 1.17}
{'loss': 0.4975, 'grad_norm': 30.354938507080078, 'learning_rate': 5.772763394882402e-06, 'rewards/chosen': 2.4739904403686523, 'rewards/rejected': 0.6967458128929138, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.7772445678710938, 'logps/chosen': -264.7410888671875, 'logps/rejected': -315.46710205078125, 'logits/chosen': -7.60152530670166, 'logits/rejected': -7.725076198577881, 'epoch': 1.22}
{'loss': 0.483, 'grad_norm': 31.095590591430664, 'learning_rate': 5.258238359385547e-06, 'rewards/chosen': 2.3383703231811523, 'rewards/rejected': 0.5459824800491333, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.792387843132019, 'logps/chosen': -277.77435302734375, 'logps/rejected': -308.74713134765625, 'logits/chosen': -7.5453081130981445, 'logits/rejected': -7.6638689041137695, 'epoch': 1.26}
{'loss': 0.5364, 'grad_norm': 54.049373626708984, 'learning_rate': 4.7560569849021865e-06, 'rewards/chosen': 1.96200692653656, 'rewards/rejected': 0.8205422163009644, 'rewards/accuracies': 0.6875, 'rewards/margins': 1.1414648294448853, 'logps/chosen': -286.7787170410156, 'logps/rejected': -300.7496032714844, 'logits/chosen': -7.632215976715088, 'logits/rejected': -7.718345642089844, 'epoch': 1.31}
{'loss': 0.5496, 'grad_norm': 16.600849151611328, 'learning_rate': 4.268560672816586e-06, 'rewards/chosen': 2.086872100830078, 'rewards/rejected': 0.9207965135574341, 'rewards/accuracies': 0.6875, 'rewards/margins': 1.1660757064819336, 'logps/chosen': -307.2585144042969, 'logps/rejected': -333.6120300292969, 'logits/chosen': -7.559038162231445, 'logits/rejected': -7.5722503662109375, 'epoch': 1.35}
{'loss': 0.4085, 'grad_norm': 19.741539001464844, 'learning_rate': 3.798022355973213e-06, 'rewards/chosen': 1.9637504816055298, 'rewards/rejected': 0.11738182604312897, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.846368432044983, 'logps/chosen': -304.2058410644531, 'logps/rejected': -325.7283935546875, 'logits/chosen': -7.663990020751953, 'logits/rejected': -7.713479042053223, 'epoch': 1.39}
{'loss': 0.424, 'grad_norm': 31.36372184753418, 'learning_rate': 3.3466359012145754e-06, 'rewards/chosen': 1.9428322315216064, 'rewards/rejected': 0.3088998794555664, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.63393235206604, 'logps/chosen': -285.6103515625, 'logps/rejected': -337.62945556640625, 'logits/chosen': -7.5927629470825195, 'logits/rejected': -7.6419572830200195, 'epoch': 1.44}
{'loss': 0.5731, 'grad_norm': 50.89725875854492, 'learning_rate': 2.916505880561294e-06, 'rewards/chosen': 1.4667940139770508, 'rewards/rejected': 0.1280805766582489, 'rewards/accuracies': 0.6875, 'rewards/margins': 1.33871328830719, 'logps/chosen': -305.38037109375, 'logps/rejected': -294.6714172363281, 'logits/chosen': -7.651500701904297, 'logits/rejected': -7.688264846801758, 'epoch': 1.48}
{'loss': 0.5608, 'grad_norm': 125.39957427978516, 'learning_rate': 2.5096377587258044e-06, 'rewards/chosen': 1.258941411972046, 'rewards/rejected': -0.34458160400390625, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.6035231351852417, 'logps/chosen': -289.51611328125, 'logps/rejected': -320.9994201660156, 'logits/chosen': -7.6455888748168945, 'logits/rejected': -7.638383865356445, 'epoch': 1.52}
{'loss': 0.4619, 'grad_norm': 78.05148315429688, 'learning_rate': 2.127928542710129e-06, 'rewards/chosen': 1.5859278440475464, 'rewards/rejected': -0.08589711040258408, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.6718248128890991, 'logps/chosen': -337.80694580078125, 'logps/rejected': -331.2950744628906, 'logits/chosen': -7.49042272567749, 'logits/rejected': -7.673018455505371, 'epoch': 1.57}
{'loss': 0.742, 'grad_norm': 264.8005676269531, 'learning_rate': 1.7731579370835323e-06, 'rewards/chosen': 1.25714910030365, 'rewards/rejected': -0.45662468671798706, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.7137738466262817, 'logps/chosen': -309.51690673828125, 'logps/rejected': -295.9734191894531, 'logits/chosen': -7.645654201507568, 'logits/rejected': -7.709648609161377, 'epoch': 1.61}
{'loss': 0.7296, 'grad_norm': 242.7531280517578, 'learning_rate': 1.4469800461782692e-06, 'rewards/chosen': 1.2812767028808594, 'rewards/rejected': -0.05279327556490898, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.3340699672698975, 'logps/chosen': -269.15484619140625, 'logps/rejected': -287.76019287109375, 'logits/chosen': -7.633023738861084, 'logits/rejected': -7.740734100341797, 'epoch': 1.65}
{'loss': 0.4033, 'grad_norm': 20.825153350830078, 'learning_rate': 1.150915661891624e-06, 'rewards/chosen': 1.9054546356201172, 'rewards/rejected': -0.08929663151502609, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.9947510957717896, 'logps/chosen': -270.49847412109375, 'logps/rejected': -329.16912841796875, 'logits/chosen': -7.680573463439941, 'logits/rejected': -7.636058807373047, 'epoch': 1.7}
{'loss': 0.4403, 'grad_norm': 69.89868927001953, 'learning_rate': 8.863451730520644e-07, 'rewards/chosen': 1.1624706983566284, 'rewards/rejected': -0.24900667369365692, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.4114773273468018, 'logps/chosen': -266.4729919433594, 'logps/rejected': -281.9223327636719, 'logits/chosen': -7.648277282714844, 'logits/rejected': -7.67885684967041, 'epoch': 1.74}
{'loss': 0.1974, 'grad_norm': 16.165679931640625, 'learning_rate': 6.545021294093052e-07, 'rewards/chosen': 1.876965880393982, 'rewards/rejected': -1.0318691730499268, 'rewards/accuracies': 0.9375, 'rewards/margins': 2.9088354110717773, 'logps/chosen': -276.294189453125, 'logps/rejected': -305.3299560546875, 'logits/chosen': -7.561076641082764, 'logits/rejected': -7.703353404998779, 'epoch': 1.79}
{'loss': 0.3618, 'grad_norm': 62.61682891845703, 'learning_rate': 4.564674902559412e-07, 'rewards/chosen': 1.3424180746078491, 'rewards/rejected': -0.5699539184570312, 'rewards/accuracies': 0.875, 'rewards/margins': 1.9123719930648804, 'logps/chosen': -259.34124755859375, 'logps/rejected': -321.6948547363281, 'logits/chosen': -7.6438212394714355, 'logits/rejected': -7.6602983474731445, 'epoch': 1.83}
{'loss': 2.5545, 'grad_norm': 1512.7396240234375, 'learning_rate': 2.931645844962453e-07, 'rewards/chosen': 1.0384113788604736, 'rewards/rejected': -0.4665493071079254, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.5049606561660767, 'logps/chosen': -289.07427978515625, 'logps/rejected': -316.67041015625, 'logits/chosen': -7.660131454467773, 'logits/rejected': -7.693356990814209, 'epoch': 1.87}
{'loss': 1.0273, 'grad_norm': 451.3190612792969, 'learning_rate': 1.6535480566057722e-07, 'rewards/chosen': 1.4121290445327759, 'rewards/rejected': -0.47929519414901733, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.8914241790771484, 'logps/chosen': -305.34112548828125, 'logps/rejected': -328.9502258300781, 'logits/chosen': -7.5992584228515625, 'logits/rejected': -7.644681453704834, 'epoch': 1.92}
{'loss': 19.5859, 'grad_norm': 10955.79296875, 'learning_rate': 7.3634061937285e-08, 'rewards/chosen': 1.1217029094696045, 'rewards/rejected': -0.047915033996105194, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.1696178913116455, 'logps/chosen': -274.0361022949219, 'logps/rejected': -322.96923828125, 'logits/chosen': -7.593007564544678, 'logits/rejected': -7.638847827911377, 'epoch': 1.96}
{'loss': 0.4585, 'grad_norm': 304.4078674316406, 'learning_rate': 1.8429997773634852e-08, 'rewards/chosen': 1.1878321170806885, 'rewards/rejected': -0.4883444905281067, 'rewards/accuracies': 0.8275862336158752, 'rewards/margins': 1.676176905632019, 'logps/chosen': -301.5126647949219, 'logps/rejected': -319.839599609375, 'logits/chosen': -7.52752161026001, 'logits/rejected': -7.637714385986328, 'epoch': 2.0}
{'train_runtime': 845.0909, 'train_samples_per_second': 1.735, 'train_steps_per_second': 0.054, 'train_loss': 3.092395478292652, 'epoch': 2.0}
Unloading and merging model: 100%|██████████| 632/632 [00:00<00:00, 6607.66it/s]
