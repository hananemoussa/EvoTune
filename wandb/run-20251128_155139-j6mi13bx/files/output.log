Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.52it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.83it/s]
Finetuning score threshold: -1509.4955500000003
Learning rate before schedule: 1e-05
Learning rate after schedule: 1.118033988749895e-05
Finetuning with 1448 chats
Extracting prompt in train dataset: 100%|██████████| 1448/1448 [00:00<00:00, 5230.65 examples/s]
Applying chat template to train dataset: 100%|██████████| 1448/1448 [00:00<00:00, 4052.56 examples/s]
Tokenizing train dataset: 100%|██████████| 1448/1448 [00:05<00:00, 255.71 examples/s]
                                                 
{'loss': 0.6931, 'grad_norm': 14.27202320098877, 'learning_rate': 1.118033988749895e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/chosen': -288.968505859375, 'logps/rejected': -289.5448913574219, 'logits/chosen': 26.641643524169922, 'logits/rejected': 26.174488067626953, 'epoch': 0.02}
{'loss': 0.7048, 'grad_norm': 18.688608169555664, 'learning_rate': 1.1177080943452458e-05, 'rewards/chosen': 0.06625136733055115, 'rewards/rejected': 0.016781803220510483, 'rewards/accuracies': 0.5, 'rewards/margins': 0.049469560384750366, 'logps/chosen': -289.6463623046875, 'logps/rejected': -270.84375, 'logits/chosen': 26.23538589477539, 'logits/rejected': 25.808732986450195, 'epoch': 0.04}
{'loss': 0.5178, 'grad_norm': 18.095287322998047, 'learning_rate': 1.116730791109596e-05, 'rewards/chosen': 0.3246288597583771, 'rewards/rejected': -0.14808999001979828, 'rewards/accuracies': 0.75, 'rewards/margins': 0.4727188050746918, 'logps/chosen': -282.7213134765625, 'logps/rejected': -265.11407470703125, 'logits/chosen': 26.264938354492188, 'logits/rejected': 25.84209442138672, 'epoch': 0.07}
{'loss': 0.6657, 'grad_norm': 46.66977310180664, 'learning_rate': 1.1151032185348012e-05, 'rewards/chosen': 0.008323673158884048, 'rewards/rejected': -0.4070705771446228, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.41539421677589417, 'logps/chosen': -293.16180419921875, 'logps/rejected': -293.88018798828125, 'logits/chosen': 26.396686553955078, 'logits/rejected': 26.138444900512695, 'epoch': 0.09}
{'loss': 0.4803, 'grad_norm': 22.786012649536133, 'learning_rate': 1.1128272742976786e-05, 'rewards/chosen': 0.3879673182964325, 'rewards/rejected': -0.416739284992218, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.8047066330909729, 'logps/chosen': -292.4512023925781, 'logps/rejected': -270.444091796875, 'logits/chosen': 26.23957061767578, 'logits/rejected': 26.016155242919922, 'epoch': 0.11}
{'loss': 0.2882, 'grad_norm': 13.559163093566895, 'learning_rate': 1.1099056120474002e-05, 'rewards/chosen': 0.5051263570785522, 'rewards/rejected': -0.5186542272567749, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.0237807035446167, 'logps/chosen': -301.1513977050781, 'logps/rejected': -284.49810791015625, 'logits/chosen': 26.682371139526367, 'logits/rejected': 25.95455551147461, 'epoch': 0.13}
{'loss': 0.1671, 'grad_norm': 10.568349838256836, 'learning_rate': 1.1063416383114573e-05, 'rewards/chosen': 0.549075186252594, 'rewards/rejected': -0.9370986819267273, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.4861738681793213, 'logps/chosen': -289.78857421875, 'logps/rejected': -270.5201721191406, 'logits/chosen': 25.999256134033203, 'logits/rejected': 25.905048370361328, 'epoch': 0.15}
{'loss': 0.7066, 'grad_norm': 85.53329467773438, 'learning_rate': 1.1021395085238007e-05, 'rewards/chosen': 0.6617064476013184, 'rewards/rejected': -1.083601951599121, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.7453083992004395, 'logps/chosen': -291.5762939453125, 'logps/rejected': -283.4872131347656, 'logits/chosen': 26.177215576171875, 'logits/rejected': 25.840425491333008, 'epoch': 0.18}
{'loss': 0.1831, 'grad_norm': 11.965256690979004, 'learning_rate': 1.097304122179792e-05, 'rewards/chosen': 0.5842238068580627, 'rewards/rejected': -1.2204217910766602, 'rewards/accuracies': 0.875, 'rewards/margins': 1.8046456575393677, 'logps/chosen': -288.9986267089844, 'logps/rejected': -283.357666015625, 'logits/chosen': 26.457752227783203, 'logits/rejected': 26.17827606201172, 'epoch': 0.2}
{'loss': 0.1881, 'grad_norm': 12.444883346557617, 'learning_rate': 1.09184111712361e-05, 'rewards/chosen': 0.6853017807006836, 'rewards/rejected': -1.829026699066162, 'rewards/accuracies': 0.875, 'rewards/margins': 2.514328718185425, 'logps/chosen': -298.24932861328125, 'logps/rejected': -274.4109191894531, 'logits/chosen': 26.513961791992188, 'logits/rejected': 25.883760452270508, 'epoch': 0.22}
{'loss': 0.2066, 'grad_norm': 2.0280165672302246, 'learning_rate': 1.0857568629747771e-05, 'rewards/chosen': 0.8690580129623413, 'rewards/rejected': -1.2586188316345215, 'rewards/accuracies': 0.84375, 'rewards/margins': 2.1276769638061523, 'logps/chosen': -286.932373046875, 'logps/rejected': -280.874267578125, 'logits/chosen': 26.221803665161133, 'logits/rejected': 25.970857620239258, 'epoch': 0.24}
{'loss': 0.1504, 'grad_norm': 3.3077316284179688, 'learning_rate': 1.079058453701468e-05, 'rewards/chosen': 0.7133932113647461, 'rewards/rejected': -1.9000788927078247, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.6134722232818604, 'logps/chosen': -310.3953552246094, 'logps/rejected': -270.5773010253906, 'logits/chosen': 26.590791702270508, 'logits/rejected': 25.687013626098633, 'epoch': 0.27}
{'loss': 0.0782, 'grad_norm': 1.8600529432296753, 'learning_rate': 1.0717536993492596e-05, 'rewards/chosen': 1.3624427318572998, 'rewards/rejected': -2.369819402694702, 'rewards/accuracies': 0.9375, 'rewards/margins': 3.732262372970581, 'logps/chosen': -298.4934997558594, 'logps/rejected': -276.11956787109375, 'logits/chosen': 26.359363555908203, 'logits/rejected': 25.61115837097168, 'epoch': 0.29}
{'loss': 0.1557, 'grad_norm': 10.058571815490723, 'learning_rate': 1.063851116934968e-05, 'rewards/chosen': 0.797749936580658, 'rewards/rejected': -2.471102237701416, 'rewards/accuracies': 0.9375, 'rewards/margins': 3.2688519954681396, 'logps/chosen': -295.48541259765625, 'logps/rejected': -285.34906005859375, 'logits/chosen': 25.947214126586914, 'logits/rejected': 25.99842643737793, 'epoch': 0.31}
{'loss': 0.1312, 'grad_norm': 6.8141703605651855, 'learning_rate': 1.0553599205161872e-05, 'rewards/chosen': 1.468336582183838, 'rewards/rejected': -2.6308441162109375, 'rewards/accuracies': 0.96875, 'rewards/margins': 4.099180698394775, 'logps/chosen': -305.8218688964844, 'logps/rejected': -272.7943420410156, 'logits/chosen': 26.445556640625, 'logits/rejected': 25.865772247314453, 'epoch': 0.33}
{'loss': 0.3389, 'grad_norm': 21.077611923217773, 'learning_rate': 1.0462900104481102e-05, 'rewards/chosen': 1.1321516036987305, 'rewards/rejected': -1.8106269836425781, 'rewards/accuracies': 0.75, 'rewards/margins': 2.9427788257598877, 'logps/chosen': -294.63153076171875, 'logps/rejected': -276.16571044921875, 'logits/chosen': 26.07118797302246, 'logits/rejected': 25.88608741760254, 'epoch': 0.35}
{'loss': 0.0875, 'grad_norm': 0.30426254868507385, 'learning_rate': 1.0366519618401579e-05, 'rewards/chosen': 1.5244442224502563, 'rewards/rejected': -3.015847682952881, 'rewards/accuracies': 0.90625, 'rewards/margins': 4.540292263031006, 'logps/chosen': -298.1580505371094, 'logps/rejected': -255.79898071289062, 'logits/chosen': 26.16507339477539, 'logits/rejected': 25.405620574951172, 'epoch': 0.38}
{'loss': 0.1233, 'grad_norm': 1.160414695739746, 'learning_rate': 1.026457012225875e-05, 'rewards/chosen': 1.4135160446166992, 'rewards/rejected': -2.573098659515381, 'rewards/accuracies': 0.90625, 'rewards/margins': 3.986614465713501, 'logps/chosen': -292.37200927734375, 'logps/rejected': -303.337890625, 'logits/chosen': 26.135032653808594, 'logits/rejected': 26.077861785888672, 'epoch': 0.4}
{'loss': 0.1171, 'grad_norm': 2.2190475463867188, 'learning_rate': 1.0157170484604672e-05, 'rewards/chosen': 1.60194730758667, 'rewards/rejected': -2.612720489501953, 'rewards/accuracies': 0.90625, 'rewards/margins': 4.214667797088623, 'logps/chosen': -307.0390930175781, 'logps/rejected': -294.7405700683594, 'logits/chosen': 26.12687110900879, 'logits/rejected': 25.732358932495117, 'epoch': 0.42}
{'loss': 0.1756, 'grad_norm': 0.46336135268211365, 'learning_rate': 1.0044445928612616e-05, 'rewards/chosen': 2.1028976440429688, 'rewards/rejected': -2.1361019611358643, 'rewards/accuracies': 0.84375, 'rewards/margins': 4.238999843597412, 'logps/chosen': -320.49627685546875, 'logps/rejected': -321.286376953125, 'logits/chosen': 26.28632164001465, 'logits/rejected': 26.104339599609375, 'epoch': 0.44}
{'loss': 0.2037, 'grad_norm': 3.9302096366882324, 'learning_rate': 9.926527886072436e-06, 'rewards/chosen': 2.357300281524658, 'rewards/rejected': -1.6400940418243408, 'rewards/accuracies': 0.84375, 'rewards/margins': 3.997394561767578, 'logps/chosen': -271.5533447265625, 'logps/rejected': -277.8665771484375, 'logits/chosen': 25.740697860717773, 'logits/rejected': 25.765037536621094, 'epoch': 0.46}
{'loss': 0.0663, 'grad_norm': 0.36229416728019714, 'learning_rate': 9.803553844146977e-06, 'rewards/chosen': 1.7565696239471436, 'rewards/rejected': -3.150909662246704, 'rewards/accuracies': 0.96875, 'rewards/margins': 4.907479286193848, 'logps/chosen': -295.5088806152344, 'logps/rejected': -274.27947998046875, 'logits/chosen': 26.004375457763672, 'logits/rejected': 25.543682098388672, 'epoch': 0.49}
{'loss': 0.1277, 'grad_norm': 0.40140658617019653, 'learning_rate': 9.67566718506821e-06, 'rewards/chosen': 2.200828790664673, 'rewards/rejected': -2.6236820220947266, 'rewards/accuracies': 0.90625, 'rewards/margins': 4.824511528015137, 'logps/chosen': -314.2623596191406, 'logps/rejected': -286.83953857421875, 'logits/chosen': 26.398651123046875, 'logits/rejected': 25.6151180267334, 'epoch': 0.51}
{'loss': 0.1239, 'grad_norm': 2.8556487560272217, 'learning_rate': 9.54301701895995e-06, 'rewards/chosen': 2.4762885570526123, 'rewards/rejected': -2.588850498199463, 'rewards/accuracies': 0.90625, 'rewards/margins': 5.065138339996338, 'logps/chosen': -284.896240234375, 'logps/rejected': -272.1412048339844, 'logits/chosen': 26.163414001464844, 'logits/rejected': 25.434120178222656, 'epoch': 0.53}
{'loss': 0.15, 'grad_norm': 0.28103405237197876, 'learning_rate': 9.405758009982126e-06, 'rewards/chosen': 2.079615592956543, 'rewards/rejected': -2.643322467803955, 'rewards/accuracies': 0.9375, 'rewards/margins': 4.722938537597656, 'logps/chosen': -284.7781066894531, 'logps/rejected': -264.90386962890625, 'logits/chosen': 26.012348175048828, 'logits/rejected': 25.44818687438965, 'epoch': 0.55}
{'loss': 0.108, 'grad_norm': 0.08499207347631454, 'learning_rate': 9.264050195999289e-06, 'rewards/chosen': 2.0539188385009766, 'rewards/rejected': -3.212463617324829, 'rewards/accuracies': 0.9375, 'rewards/margins': 5.266382217407227, 'logps/chosen': -275.67681884765625, 'logps/rejected': -273.85528564453125, 'logits/chosen': 25.41143226623535, 'logits/rejected': 25.213045120239258, 'epoch': 0.57}
{'loss': 0.1628, 'grad_norm': 2.978184938430786, 'learning_rate': 9.118058801983619e-06, 'rewards/chosen': 2.075763463973999, 'rewards/rejected': -2.6607205867767334, 'rewards/accuracies': 0.96875, 'rewards/margins': 4.736484050750732, 'logps/chosen': -283.6590881347656, 'logps/rejected': -293.6236267089844, 'logits/chosen': 25.56539535522461, 'logits/rejected': 25.64681053161621, 'epoch': 0.6}
{'loss': 0.2779, 'grad_norm': 0.48094964027404785, 'learning_rate': 8.967954047369998e-06, 'rewards/chosen': 2.345949172973633, 'rewards/rejected': -1.8738417625427246, 'rewards/accuracies': 0.8125, 'rewards/margins': 4.219790935516357, 'logps/chosen': -279.26373291015625, 'logps/rejected': -318.412109375, 'logits/chosen': 26.013015747070312, 'logits/rejected': 26.34107208251953, 'epoch': 0.62}
{'loss': 0.1591, 'grad_norm': 3.217750072479248, 'learning_rate': 8.813910947587772e-06, 'rewards/chosen': 2.0168094635009766, 'rewards/rejected': -3.331118106842041, 'rewards/accuracies': 0.9375, 'rewards/margins': 5.347928047180176, 'logps/chosen': -316.7223205566406, 'logps/rejected': -288.1284484863281, 'logits/chosen': 25.956912994384766, 'logits/rejected': 25.789722442626953, 'epoch': 0.64}
{'loss': 0.1359, 'grad_norm': 1.3347580432891846, 'learning_rate': 8.656109110000574e-06, 'rewards/chosen': 1.7788320779800415, 'rewards/rejected': -3.6640586853027344, 'rewards/accuracies': 0.875, 'rewards/margins': 5.442890644073486, 'logps/chosen': -298.69293212890625, 'logps/rejected': -272.6767272949219, 'logits/chosen': 26.126432418823242, 'logits/rejected': 25.571575164794922, 'epoch': 0.66}
{'loss': 0.1169, 'grad_norm': 1.8689543008804321, 'learning_rate': 8.494732524492185e-06, 'rewards/chosen': 2.0257041454315186, 'rewards/rejected': -3.8551502227783203, 'rewards/accuracies': 0.90625, 'rewards/margins': 5.880854606628418, 'logps/chosen': -277.3343811035156, 'logps/rejected': -273.4495544433594, 'logits/chosen': 25.704761505126953, 'logits/rejected': 25.857900619506836, 'epoch': 0.69}
{'loss': 0.1777, 'grad_norm': 2.2471182346343994, 'learning_rate': 8.329969348942556e-06, 'rewards/chosen': 1.8247995376586914, 'rewards/rejected': -3.4682631492614746, 'rewards/accuracies': 0.90625, 'rewards/margins': 5.293062686920166, 'logps/chosen': -292.77777099609375, 'logps/rejected': -281.7655334472656, 'logits/chosen': 25.469566345214844, 'logits/rejected': 25.63413429260254, 'epoch': 0.71}
{'loss': 0.153, 'grad_norm': 0.28282594680786133, 'learning_rate': 8.16201168984413e-06, 'rewards/chosen': 1.8558708429336548, 'rewards/rejected': -3.824023723602295, 'rewards/accuracies': 0.875, 'rewards/margins': 5.679894924163818, 'logps/chosen': -280.15496826171875, 'logps/rejected': -270.3424987792969, 'logits/chosen': 25.762435913085938, 'logits/rejected': 25.245092391967773, 'epoch': 0.73}
{'loss': 0.0913, 'grad_norm': 1.7029448747634888, 'learning_rate': 7.99105537831428e-06, 'rewards/chosen': 1.5724337100982666, 'rewards/rejected': -4.953475475311279, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.525908946990967, 'logps/chosen': -288.9297180175781, 'logps/rejected': -287.9156188964844, 'logits/chosen': 25.899192810058594, 'logits/rejected': 25.558563232421875, 'epoch': 0.75}
{'loss': 0.1389, 'grad_norm': 1.5530941486358643, 'learning_rate': 7.81729974176497e-06, 'rewards/chosen': 1.264146089553833, 'rewards/rejected': -4.090667724609375, 'rewards/accuracies': 0.96875, 'rewards/margins': 5.354813098907471, 'logps/chosen': -305.2309875488281, 'logps/rejected': -296.846435546875, 'logits/chosen': 25.92648696899414, 'logits/rejected': 25.39193344116211, 'epoch': 0.77}
{'loss': 0.1607, 'grad_norm': 3.920865297317505, 'learning_rate': 7.640947371495918e-06, 'rewards/chosen': 1.4544039964675903, 'rewards/rejected': -4.1169891357421875, 'rewards/accuracies': 0.96875, 'rewards/margins': 5.571393013000488, 'logps/chosen': -305.13433837890625, 'logps/rejected': -291.22967529296875, 'logits/chosen': 25.825786590576172, 'logits/rejected': 25.535057067871094, 'epoch': 0.8}
{'loss': 0.0796, 'grad_norm': 1.567338228225708, 'learning_rate': 7.4622038864822025e-06, 'rewards/chosen': 0.9804016351699829, 'rewards/rejected': -5.68827486038208, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.668676376342773, 'logps/chosen': -292.8395690917969, 'logps/rejected': -269.40582275390625, 'logits/chosen': 25.65897560119629, 'logits/rejected': 25.189857482910156, 'epoch': 0.82}
{'loss': 0.2144, 'grad_norm': 12.406373977661133, 'learning_rate': 7.281277693631737e-06, 'rewards/chosen': 1.2198219299316406, 'rewards/rejected': -4.746917724609375, 'rewards/accuracies': 0.875, 'rewards/margins': 5.966739654541016, 'logps/chosen': -315.0626525878906, 'logps/rejected': -283.2298889160156, 'logits/chosen': 25.91214942932129, 'logits/rejected': 25.47003746032715, 'epoch': 0.84}
{'loss': 0.5384, 'grad_norm': 71.5224609375, 'learning_rate': 7.098379744792127e-06, 'rewards/chosen': 1.6720737218856812, 'rewards/rejected': -4.293902397155762, 'rewards/accuracies': 0.8125, 'rewards/margins': 5.965976238250732, 'logps/chosen': -272.02301025390625, 'logps/rejected': -301.26116943359375, 'logits/chosen': 25.612586975097656, 'logits/rejected': 25.820411682128906, 'epoch': 0.86}
{'loss': 0.1134, 'grad_norm': 4.615065574645996, 'learning_rate': 6.913723290790269e-06, 'rewards/chosen': 1.0016899108886719, 'rewards/rejected': -5.364457130432129, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.366147041320801, 'logps/chosen': -292.5538635253906, 'logps/rejected': -291.7532958984375, 'logits/chosen': 25.64464569091797, 'logits/rejected': 25.649497985839844, 'epoch': 0.88}
{'loss': 0.2045, 'grad_norm': 1.2834348678588867, 'learning_rate': 6.7275236327914105e-06, 'rewards/chosen': 1.3246592283248901, 'rewards/rejected': -4.091875076293945, 'rewards/accuracies': 0.875, 'rewards/margins': 5.416533946990967, 'logps/chosen': -286.77783203125, 'logps/rejected': -276.3902282714844, 'logits/chosen': 25.644638061523438, 'logits/rejected': 25.3033390045166, 'epoch': 0.91}
{'loss': 0.1043, 'grad_norm': 0.7813513278961182, 'learning_rate': 6.539997871267629e-06, 'rewards/chosen': 1.8052622079849243, 'rewards/rejected': -5.316262245178223, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.121523857116699, 'logps/chosen': -293.1526184082031, 'logps/rejected': -268.1328430175781, 'logits/chosen': 25.84128189086914, 'logits/rejected': 25.25579261779785, 'epoch': 0.93}
{'loss': 0.1114, 'grad_norm': 2.407421112060547, 'learning_rate': 6.351364652868396e-06, 'rewards/chosen': 1.2499538660049438, 'rewards/rejected': -5.577981472015381, 'rewards/accuracies': 0.96875, 'rewards/margins': 6.827935218811035, 'logps/chosen': -294.04345703125, 'logps/rejected': -287.0444030761719, 'logits/chosen': 25.66465187072754, 'logits/rejected': 25.16372299194336, 'epoch': 0.95}
{'loss': 0.1635, 'grad_norm': 12.347853660583496, 'learning_rate': 6.1618439154883545e-06, 'rewards/chosen': 1.5511150360107422, 'rewards/rejected': -5.465174674987793, 'rewards/accuracies': 0.90625, 'rewards/margins': 7.016289710998535, 'logps/chosen': -292.439208984375, 'logps/rejected': -293.73876953125, 'logits/chosen': 25.698537826538086, 'logits/rejected': 25.776294708251953, 'epoch': 0.97}
{'loss': 0.0564, 'grad_norm': 1.3953806161880493, 'learning_rate': 5.971656631829587e-06, 'rewards/chosen': 0.8176571130752563, 'rewards/rejected': -6.017147064208984, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.834804058074951, 'logps/chosen': -294.72625732421875, 'logps/rejected': -291.6878356933594, 'logits/chosen': 25.619874954223633, 'logits/rejected': 25.18691635131836, 'epoch': 0.99}
{'loss': 0.1245, 'grad_norm': 8.819408416748047, 'learning_rate': 5.781024551757312e-06, 'rewards/chosen': 1.0123398303985596, 'rewards/rejected': -5.217437744140625, 'rewards/accuracies': 0.875, 'rewards/margins': 6.2297773361206055, 'logps/chosen': -312.78662109375, 'logps/rejected': -288.602294921875, 'logits/chosen': 25.751548767089844, 'logits/rejected': 25.503482818603516, 'epoch': 1.0}
{'loss': 0.2031, 'grad_norm': 5.405297756195068, 'learning_rate': 5.590169943749475e-06, 'rewards/chosen': 0.9621818661689758, 'rewards/rejected': -4.81802225112915, 'rewards/accuracies': 0.8125, 'rewards/margins': 5.780203342437744, 'logps/chosen': -297.1636047363281, 'logps/rejected': -289.1123046875, 'logits/chosen': 25.806276321411133, 'logits/rejected': 25.414241790771484, 'epoch': 1.02}
{'loss': 0.5714, 'grad_norm': 84.66023254394531, 'learning_rate': 5.399315335741639e-06, 'rewards/chosen': 0.9657003283500671, 'rewards/rejected': -5.7351298332214355, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.700830936431885, 'logps/chosen': -295.35577392578125, 'logps/rejected': -279.8772888183594, 'logits/chosen': 25.803848266601562, 'logits/rejected': 25.545873641967773, 'epoch': 1.04}
{'loss': 0.0867, 'grad_norm': 0.3857608735561371, 'learning_rate': 5.208683255669365e-06, 'rewards/chosen': 0.9655071496963501, 'rewards/rejected': -6.177765846252441, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.14327335357666, 'logps/chosen': -301.9722595214844, 'logps/rejected': -289.8797607421875, 'logits/chosen': 26.127023696899414, 'logits/rejected': 25.628616333007812, 'epoch': 1.07}
{'loss': 0.1129, 'grad_norm': 2.0439398288726807, 'learning_rate': 5.018495972010595e-06, 'rewards/chosen': 0.9701841473579407, 'rewards/rejected': -5.41920280456543, 'rewards/accuracies': 0.875, 'rewards/margins': 6.389386177062988, 'logps/chosen': -292.99102783203125, 'logps/rejected': -296.67529296875, 'logits/chosen': 25.726585388183594, 'logits/rejected': 25.443296432495117, 'epoch': 1.09}
{'loss': 0.1719, 'grad_norm': 8.448652267456055, 'learning_rate': 4.828975234630557e-06, 'rewards/chosen': 1.022822618484497, 'rewards/rejected': -5.448935508728027, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.471757888793945, 'logps/chosen': -286.27496337890625, 'logps/rejected': -289.7628479003906, 'logits/chosen': 25.579647064208984, 'logits/rejected': 25.249338150024414, 'epoch': 1.11}
{'loss': 0.0941, 'grad_norm': 1.7535585165023804, 'learning_rate': 4.640342016231322e-06, 'rewards/chosen': 1.4212396144866943, 'rewards/rejected': -5.617770195007324, 'rewards/accuracies': 0.90625, 'rewards/margins': 7.039010047912598, 'logps/chosen': -301.1446838378906, 'logps/rejected': -272.52783203125, 'logits/chosen': 26.059846878051758, 'logits/rejected': 25.47130012512207, 'epoch': 1.13}
{'loss': 0.115, 'grad_norm': 1.3088383674621582, 'learning_rate': 4.452816254707542e-06, 'rewards/chosen': 1.3820279836654663, 'rewards/rejected': -5.442239284515381, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.8242669105529785, 'logps/chosen': -284.6591796875, 'logps/rejected': -305.049072265625, 'logits/chosen': 25.515018463134766, 'logits/rejected': 25.67758560180664, 'epoch': 1.15}
{'loss': 0.1278, 'grad_norm': 3.307980537414551, 'learning_rate': 4.2666165967086816e-06, 'rewards/chosen': 1.352000117301941, 'rewards/rejected': -4.769239902496338, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.12123966217041, 'logps/chosen': -294.188720703125, 'logps/rejected': -270.58941650390625, 'logits/chosen': 26.023944854736328, 'logits/rejected': 25.34178352355957, 'epoch': 1.18}
{'loss': 0.0711, 'grad_norm': 0.8964827060699463, 'learning_rate': 4.081960142706822e-06, 'rewards/chosen': 1.7192319631576538, 'rewards/rejected': -6.017767429351807, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.73699951171875, 'logps/chosen': -288.3089904785156, 'logps/rejected': -273.53118896484375, 'logits/chosen': 25.3355655670166, 'logits/rejected': 25.294328689575195, 'epoch': 1.2}
{'loss': 0.1567, 'grad_norm': 0.9154396057128906, 'learning_rate': 3.899062193867214e-06, 'rewards/chosen': 1.725097417831421, 'rewards/rejected': -4.631287097930908, 'rewards/accuracies': 0.875, 'rewards/margins': 6.35638427734375, 'logps/chosen': -294.8665466308594, 'logps/rejected': -289.8890686035156, 'logits/chosen': 25.538738250732422, 'logits/rejected': 25.430131912231445, 'epoch': 1.22}
{'loss': 0.0718, 'grad_norm': 3.486313581466675, 'learning_rate': 3.7181360010167476e-06, 'rewards/chosen': 1.6223033666610718, 'rewards/rejected': -5.9218034744262695, 'rewards/accuracies': 1.0, 'rewards/margins': 7.544106483459473, 'logps/chosen': -321.835205078125, 'logps/rejected': -312.9363098144531, 'logits/chosen': 25.788965225219727, 'logits/rejected': 25.595584869384766, 'epoch': 1.24}
{'loss': 0.2334, 'grad_norm': 9.11882209777832, 'learning_rate': 3.5393925160030344e-06, 'rewards/chosen': 1.120988130569458, 'rewards/rejected': -4.580552101135254, 'rewards/accuracies': 0.84375, 'rewards/margins': 5.701539993286133, 'logps/chosen': -310.0555725097656, 'logps/rejected': -321.2856750488281, 'logits/chosen': 25.54905891418457, 'logits/rejected': 25.697614669799805, 'epoch': 1.27}
{'loss': 0.1667, 'grad_norm': 2.789641857147217, 'learning_rate': 3.363040145733982e-06, 'rewards/chosen': 1.3080793619155884, 'rewards/rejected': -4.84102725982666, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.149106979370117, 'logps/chosen': -298.4142150878906, 'logps/rejected': -275.2579345703125, 'logits/chosen': 25.91982650756836, 'logits/rejected': 25.313913345336914, 'epoch': 1.29}
{'loss': 0.0437, 'grad_norm': 1.1447206735610962, 'learning_rate': 3.189284509184672e-06, 'rewards/chosen': 1.0895839929580688, 'rewards/rejected': -6.0524163246154785, 'rewards/accuracies': 1.0, 'rewards/margins': 7.142000198364258, 'logps/chosen': -292.31353759765625, 'logps/rejected': -286.90557861328125, 'logits/chosen': 25.54570198059082, 'logits/rejected': 25.534198760986328, 'epoch': 1.31}
{'loss': 0.0569, 'grad_norm': 3.077807903289795, 'learning_rate': 3.01832819765482e-06, 'rewards/chosen': 0.9425804615020752, 'rewards/rejected': -6.504952907562256, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.44753360748291, 'logps/chosen': -288.1794128417969, 'logps/rejected': -283.060302734375, 'logits/chosen': 25.82840347290039, 'logits/rejected': 25.4438533782959, 'epoch': 1.33}
{'loss': 0.1203, 'grad_norm': 1.6849156618118286, 'learning_rate': 2.8503705385563972e-06, 'rewards/chosen': 1.1329336166381836, 'rewards/rejected': -5.512056350708008, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.644989490509033, 'logps/chosen': -296.7811584472656, 'logps/rejected': -299.3721008300781, 'logits/chosen': 25.880239486694336, 'logits/rejected': 25.531768798828125, 'epoch': 1.35}
{'loss': 0.4591, 'grad_norm': 81.82706451416016, 'learning_rate': 2.685607363006767e-06, 'rewards/chosen': 1.0674835443496704, 'rewards/rejected': -6.330599784851074, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.398082733154297, 'logps/chosen': -289.825927734375, 'logps/rejected': -285.13232421875, 'logits/chosen': 25.56207275390625, 'logits/rejected': 25.657958984375, 'epoch': 1.38}
{'loss': 0.7722, 'grad_norm': 165.55604553222656, 'learning_rate': 2.5242307774983756e-06, 'rewards/chosen': 1.0996553897857666, 'rewards/rejected': -5.84650993347168, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.946165084838867, 'logps/chosen': -288.3263244628906, 'logps/rejected': -281.6055603027344, 'logits/chosen': 25.716724395751953, 'logits/rejected': 25.154516220092773, 'epoch': 1.4}
{'loss': 0.2718, 'grad_norm': 27.138126373291016, 'learning_rate': 2.3664289399111796e-06, 'rewards/chosen': 1.198984146118164, 'rewards/rejected': -5.475626468658447, 'rewards/accuracies': 0.8125, 'rewards/margins': 6.6746110916137695, 'logps/chosen': -291.1095886230469, 'logps/rejected': -288.85400390625, 'logits/chosen': 25.39322853088379, 'logits/rejected': 25.07258415222168, 'epoch': 1.42}
{'loss': 0.1218, 'grad_norm': 1.9681930541992188, 'learning_rate': 2.2123858401289524e-06, 'rewards/chosen': 1.0915603637695312, 'rewards/rejected': -5.9006171226501465, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.992177486419678, 'logps/chosen': -279.2212829589844, 'logps/rejected': -267.44866943359375, 'logits/chosen': 25.552520751953125, 'logits/rejected': 25.379587173461914, 'epoch': 1.44}
{'loss': 0.1907, 'grad_norm': 5.36834716796875, 'learning_rate': 2.062281085515334e-06, 'rewards/chosen': 1.1633714437484741, 'rewards/rejected': -5.301845550537109, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.465216636657715, 'logps/chosen': -294.9729919433594, 'logps/rejected': -294.561279296875, 'logits/chosen': 25.51408576965332, 'logits/rejected': 25.222583770751953, 'epoch': 1.46}
{'loss': 1.8668, 'grad_norm': 322.2979736328125, 'learning_rate': 1.916289691499661e-06, 'rewards/chosen': 1.058433175086975, 'rewards/rejected': -5.98334264755249, 'rewards/accuracies': 0.875, 'rewards/margins': 7.041775226593018, 'logps/chosen': -308.0458679199219, 'logps/rejected': -297.3677978515625, 'logits/chosen': 26.139265060424805, 'logits/rejected': 25.63996696472168, 'epoch': 1.49}
{'loss': 0.1793, 'grad_norm': 4.7018890380859375, 'learning_rate': 1.7745818775168253e-06, 'rewards/chosen': 1.1458953619003296, 'rewards/rejected': -5.131823539733887, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.2777180671691895, 'logps/chosen': -286.2259521484375, 'logps/rejected': -286.7226867675781, 'logits/chosen': 25.988967895507812, 'logits/rejected': 25.762680053710938, 'epoch': 1.51}
{'loss': 0.065, 'grad_norm': 0.10483361035585403, 'learning_rate': 1.6373228685390007e-06, 'rewards/chosen': 1.1720608472824097, 'rewards/rejected': -6.425815582275391, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.59787654876709, 'logps/chosen': -274.0447082519531, 'logps/rejected': -270.2953186035156, 'logits/chosen': 25.564361572265625, 'logits/rejected': 25.285964965820312, 'epoch': 1.53}
{'loss': 0.1567, 'grad_norm': 1.5338436365127563, 'learning_rate': 1.5046727024307404e-06, 'rewards/chosen': 1.2045217752456665, 'rewards/rejected': -5.368096351623535, 'rewards/accuracies': 0.875, 'rewards/margins': 6.57261848449707, 'logps/chosen': -292.9573059082031, 'logps/rejected': -286.6557312011719, 'logits/chosen': 25.821460723876953, 'logits/rejected': 25.475339889526367, 'epoch': 1.55}
{'loss': 0.084, 'grad_norm': 0.5102912187576294, 'learning_rate': 1.3767860433519756e-06, 'rewards/chosen': 1.6828855276107788, 'rewards/rejected': -6.105273723602295, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.788159370422363, 'logps/chosen': -288.952392578125, 'logps/rejected': -295.5946960449219, 'logits/chosen': 25.795204162597656, 'logits/rejected': 25.620140075683594, 'epoch': 1.57}
{'loss': 0.2324, 'grad_norm': 27.628366470336914, 'learning_rate': 1.2538120014265154e-06, 'rewards/chosen': 1.147589087486267, 'rewards/rejected': -5.128150463104248, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.275739669799805, 'logps/chosen': -298.1153564453125, 'logps/rejected': -290.611572265625, 'logits/chosen': 25.59264373779297, 'logits/rejected': 25.46663475036621, 'epoch': 1.6}
{'loss': 0.2703, 'grad_norm': 27.551172256469727, 'learning_rate': 1.1358939588863341e-06, 'rewards/chosen': 1.623569130897522, 'rewards/rejected': -5.420510292053223, 'rewards/accuracies': 0.84375, 'rewards/margins': 7.044078826904297, 'logps/chosen': -279.9720458984375, 'logps/rejected': -293.4093933105469, 'logits/chosen': 25.544010162353516, 'logits/rejected': 25.52915382385254, 'epoch': 1.62}
{'loss': 0.0601, 'grad_norm': 0.9098773002624512, 'learning_rate': 1.023169402894278e-06, 'rewards/chosen': 1.2717078924179077, 'rewards/rejected': -6.451272010803223, 'rewards/accuracies': 1.0, 'rewards/margins': 7.722980976104736, 'logps/chosen': -305.3221740722656, 'logps/rejected': -288.74609375, 'logits/chosen': 25.751087188720703, 'logits/rejected': 25.364765167236328, 'epoch': 1.64}
{'loss': 0.1604, 'grad_norm': 4.716400623321533, 'learning_rate': 9.157697652402029e-07, 'rewards/chosen': 1.2117136716842651, 'rewards/rejected': -4.942229747772217, 'rewards/accuracies': 0.875, 'rewards/margins': 6.15394401550293, 'logps/chosen': -297.7672119140625, 'logps/rejected': -296.2227783203125, 'logits/chosen': 25.483707427978516, 'logits/rejected': 25.69558334350586, 'epoch': 1.66}
{'loss': 0.087, 'grad_norm': 3.945925235748291, 'learning_rate': 8.138202690973711e-07, 'rewards/chosen': 1.093928575515747, 'rewards/rejected': -6.323277473449707, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.417205810546875, 'logps/chosen': -291.86309814453125, 'logps/rejected': -273.7747497558594, 'logits/chosen': 25.847797393798828, 'logits/rejected': 25.257875442504883, 'epoch': 1.69}
{'loss': 0.1369, 'grad_norm': 6.198428153991699, 'learning_rate': 7.174397830178484e-07, 'rewards/chosen': 0.9210317730903625, 'rewards/rejected': -5.5453619956970215, 'rewards/accuracies': 0.875, 'rewards/margins': 6.46639347076416, 'logps/chosen': -282.18695068359375, 'logps/rejected': -285.58099365234375, 'logits/chosen': 25.335538864135742, 'logits/rejected': 25.336933135986328, 'epoch': 1.71}
{'loss': 1.2833, 'grad_norm': 223.86058044433594, 'learning_rate': 6.267406823370788e-07, 'rewards/chosen': 1.9483979940414429, 'rewards/rejected': -5.642881393432617, 'rewards/accuracies': 0.90625, 'rewards/margins': 7.591279029846191, 'logps/chosen': -300.9212646484375, 'logps/rejected': -306.7120056152344, 'logits/chosen': 25.815431594848633, 'logits/rejected': 25.464948654174805, 'epoch': 1.73}
{'loss': 1.1346, 'grad_norm': 190.3201446533203, 'learning_rate': 5.418287181492697e-07, 'rewards/chosen': 1.206010103225708, 'rewards/rejected': -5.159729480743408, 'rewards/accuracies': 0.875, 'rewards/margins': 6.365739822387695, 'logps/chosen': -290.30987548828125, 'logps/rejected': -276.2093811035156, 'logits/chosen': 25.63936996459961, 'logits/rejected': 25.174379348754883, 'epoch': 1.75}
{'loss': 0.1325, 'grad_norm': 3.216731309890747, 'learning_rate': 4.6280289400635503e-07, 'rewards/chosen': 1.466909408569336, 'rewards/rejected': -4.7956085205078125, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.262518405914307, 'logps/chosen': -306.262939453125, 'logps/rejected': -287.1999816894531, 'logits/chosen': 26.04841423034668, 'logits/rejected': 25.450002670288086, 'epoch': 1.77}
{'loss': 0.75, 'grad_norm': 118.64849090576172, 'learning_rate': 3.8975535048427106e-07, 'rewards/chosen': 1.2618234157562256, 'rewards/rejected': -5.810397148132324, 'rewards/accuracies': 0.875, 'rewards/margins': 7.072220802307129, 'logps/chosen': -285.0756530761719, 'logps/rejected': -278.790283203125, 'logits/chosen': 25.389793395996094, 'logits/rejected': 25.477703094482422, 'epoch': 1.8}
{'loss': 0.126, 'grad_norm': 1.8092317581176758, 'learning_rate': 3.2277125775118035e-07, 'rewards/chosen': 1.459172248840332, 'rewards/rejected': -5.847712993621826, 'rewards/accuracies': 0.90625, 'rewards/margins': 7.306884765625, 'logps/chosen': -316.97509765625, 'logps/rejected': -287.713134765625, 'logits/chosen': 25.973432540893555, 'logits/rejected': 25.025188446044922, 'epoch': 1.82}
{'loss': 0.1186, 'grad_norm': 2.491518497467041, 'learning_rate': 2.619287162628511e-07, 'rewards/chosen': 1.8132115602493286, 'rewards/rejected': -5.738211631774902, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.551423072814941, 'logps/chosen': -285.342529296875, 'logps/rejected': -290.06671142578125, 'logits/chosen': 25.509008407592773, 'logits/rejected': 25.31499671936035, 'epoch': 1.84}
{'loss': 0.0813, 'grad_norm': 3.187629222869873, 'learning_rate': 2.0729866570103166e-07, 'rewards/chosen': 1.5791964530944824, 'rewards/rejected': -5.975559711456299, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.554756164550781, 'logps/chosen': -288.4042663574219, 'logps/rejected': -258.34625244140625, 'logits/chosen': 25.84132957458496, 'logits/rejected': 25.36375617980957, 'epoch': 1.86}
{'loss': 0.1949, 'grad_norm': 1.7900416851043701, 'learning_rate': 1.589448022609435e-07, 'rewards/chosen': 1.6050710678100586, 'rewards/rejected': -4.5179643630981445, 'rewards/accuracies': 0.875, 'rewards/margins': 6.123035430908203, 'logps/chosen': -293.35675048828125, 'logps/rejected': -290.0417785644531, 'logits/chosen': 25.652345657348633, 'logits/rejected': 25.481142044067383, 'epoch': 1.88}
{'loss': 0.1247, 'grad_norm': 3.4122509956359863, 'learning_rate': 1.1692350438437788e-07, 'rewards/chosen': 1.5006027221679688, 'rewards/rejected': -5.42255973815918, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.923162937164307, 'logps/chosen': -298.5200500488281, 'logps/rejected': -297.0222473144531, 'logits/chosen': 25.95403480529785, 'logits/rejected': 25.444305419921875, 'epoch': 1.91}
{'loss': 0.1739, 'grad_norm': 28.693483352661133, 'learning_rate': 8.128376702494785e-08, 'rewards/chosen': 1.5730259418487549, 'rewards/rejected': -5.505450248718262, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.0784759521484375, 'logps/chosen': -307.03912353515625, 'logps/rejected': -317.1673278808594, 'logits/chosen': 25.890178680419922, 'logits/rejected': 25.74439811706543, 'epoch': 1.93}
{'loss': 0.06, 'grad_norm': 1.1257264614105225, 'learning_rate': 5.206714452216448e-08, 'rewards/chosen': 1.7255580425262451, 'rewards/rejected': -6.0598530769348145, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.7854108810424805, 'logps/chosen': -293.57012939453125, 'logps/rejected': -286.87554931640625, 'logits/chosen': 25.347097396850586, 'logits/rejected': 25.454174041748047, 'epoch': 1.95}
{'loss': 0.1344, 'grad_norm': 4.386428356170654, 'learning_rate': 2.9307702150938152e-08, 'rewards/chosen': 1.57268488407135, 'rewards/rejected': -4.739512920379639, 'rewards/accuracies': 1.0, 'rewards/margins': 6.312197685241699, 'logps/chosen': -295.4167785644531, 'logps/rejected': -323.8323974609375, 'logits/chosen': 26.061893463134766, 'logits/rejected': 25.57927131652832, 'epoch': 1.97}
{'loss': 0.0832, 'grad_norm': 0.5441668629646301, 'learning_rate': 1.3031976402990178e-08, 'rewards/chosen': 1.1679356098175049, 'rewards/rejected': -5.828778266906738, 'rewards/accuracies': 0.96875, 'rewards/margins': 6.996714115142822, 'logps/chosen': -275.14996337890625, 'logps/rejected': -292.87384033203125, 'logits/chosen': 25.331470489501953, 'logits/rejected': 25.5543212890625, 'epoch': 1.99}
{'loss': 0.2808, 'grad_norm': 11.988632202148438, 'learning_rate': 3.25894404649216e-09, 'rewards/chosen': 1.5843567848205566, 'rewards/rejected': -4.143953323364258, 'rewards/accuracies': 0.75, 'rewards/margins': 5.7283101081848145, 'logps/chosen': -259.0954895019531, 'logps/rejected': -307.91796875, 'logits/chosen': 25.519664764404297, 'logits/rejected': 25.73753547668457, 'epoch': 2.0}
{'train_runtime': 4928.5781, 'train_samples_per_second': 0.588, 'train_steps_per_second': 0.019, 'train_loss': 0.24369354214033354, 'epoch': 2.0}
Unloading and merging model: 100%|██████████| 519/519 [00:00<00:00, 2909.52it/s]
