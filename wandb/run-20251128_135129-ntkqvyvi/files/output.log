Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.56it/s]
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.96it/s]
Finetuning score threshold: -10000.0
Learning rate before schedule: 1e-05
Learning rate after schedule: 1.5811388300841898e-05
Finetuning with 1088 chats
Extracting prompt in train dataset: 100%|██████████| 1088/1088 [00:00<00:00, 5070.44 examples/s]
Applying chat template to train dataset: 100%|██████████| 1088/1088 [00:00<00:00, 4003.61 examples/s]
Tokenizing train dataset: 100%|██████████| 1088/1088 [00:03<00:00, 299.30 examples/s]
                                               
{'loss': 0.6931, 'grad_norm': 13.626165390014648, 'learning_rate': 1.5811388300841898e-05, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/chosen': -310.392333984375, 'logps/rejected': -271.2165222167969, 'logits/chosen': 26.703706741333008, 'logits/rejected': 26.26349639892578, 'epoch': 0.03}
{'loss': 0.8186, 'grad_norm': 61.14170837402344, 'learning_rate': 1.5802952725978664e-05, 'rewards/chosen': -0.1345762312412262, 'rewards/rejected': -0.35067886114120483, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.21610260009765625, 'logps/chosen': -325.5042724609375, 'logps/rejected': -320.69195556640625, 'logits/chosen': 27.041271209716797, 'logits/rejected': 26.159757614135742, 'epoch': 0.06}
{'loss': 0.5863, 'grad_norm': 17.153152465820312, 'learning_rate': 1.5777664003330826e-05, 'rewards/chosen': 0.06010055169463158, 'rewards/rejected': -0.2125558853149414, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.27265647053718567, 'logps/chosen': -312.9030456542969, 'logps/rejected': -306.4719543457031, 'logits/chosen': 26.568326950073242, 'logits/rejected': 26.348217010498047, 'epoch': 0.09}
{'loss': 0.4624, 'grad_norm': 15.970931053161621, 'learning_rate': 1.573557610030695e-05, 'rewards/chosen': 0.27242106199264526, 'rewards/rejected': -0.3011770248413086, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.5735980868339539, 'logps/chosen': -314.76165771484375, 'logps/rejected': -293.1115417480469, 'logits/chosen': 26.755521774291992, 'logits/rejected': 25.93623924255371, 'epoch': 0.12}
{'loss': 0.4369, 'grad_norm': 12.333544731140137, 'learning_rate': 1.5676778834613122e-05, 'rewards/chosen': 0.5593883395195007, 'rewards/rejected': -0.37961119413375854, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.9389995336532593, 'logps/chosen': -342.1976013183594, 'logps/rejected': -312.66717529296875, 'logits/chosen': 27.023258209228516, 'logits/rejected': 26.282678604125977, 'epoch': 0.15}
{'loss': 0.3669, 'grad_norm': 12.218713760375977, 'learning_rate': 1.560139768257743e-05, 'rewards/chosen': 0.5159782767295837, 'rewards/rejected': -0.37191271781921387, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.8878909945487976, 'logps/chosen': -326.6910705566406, 'logps/rejected': -332.6444396972656, 'logits/chosen': 27.08458137512207, 'logits/rejected': 26.62079429626465, 'epoch': 0.18}
{'loss': 0.2117, 'grad_norm': 4.444846153259277, 'learning_rate': 1.550959351137717e-05, 'rewards/chosen': 0.758723258972168, 'rewards/rejected': -0.9539007544517517, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.712623953819275, 'logps/chosen': -308.91668701171875, 'logps/rejected': -316.67706298828125, 'logits/chosen': 26.529062271118164, 'logits/rejected': 26.34162712097168, 'epoch': 0.21}
{'loss': 0.1608, 'grad_norm': 3.6905417442321777, 'learning_rate': 1.5401562235740187e-05, 'rewards/chosen': 0.6844531893730164, 'rewards/rejected': -1.6771997213363647, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.3616528511047363, 'logps/chosen': -342.40753173828125, 'logps/rejected': -303.348388671875, 'logits/chosen': 26.815351486206055, 'logits/rejected': 25.98093605041504, 'epoch': 0.24}
{'loss': 0.1484, 'grad_norm': 8.408002853393555, 'learning_rate': 1.5277534399852945e-05, 'rewards/chosen': 0.5542827844619751, 'rewards/rejected': -2.399688482284546, 'rewards/accuracies': 0.90625, 'rewards/margins': 2.9539716243743896, 'logps/chosen': -324.5206298828125, 'logps/rejected': -312.4469299316406, 'logits/chosen': 26.577686309814453, 'logits/rejected': 26.166400909423828, 'epoch': 0.26}
{'loss': 0.2023, 'grad_norm': 2.492382049560547, 'learning_rate': 1.5137774685367648e-05, 'rewards/chosen': 0.9107729196548462, 'rewards/rejected': -1.931105613708496, 'rewards/accuracies': 0.84375, 'rewards/margins': 2.841878652572632, 'logps/chosen': -345.8133850097656, 'logps/rejected': -318.0251770019531, 'logits/chosen': 26.923303604125977, 'logits/rejected': 26.314212799072266, 'epoch': 0.29}
{'loss': 0.2471, 'grad_norm': 10.824222564697266, 'learning_rate': 1.4982581346558229e-05, 'rewards/chosen': 0.8609066605567932, 'rewards/rejected': -2.184931755065918, 'rewards/accuracies': 0.90625, 'rewards/margins': 3.0458383560180664, 'logps/chosen': -322.9563903808594, 'logps/rejected': -288.3271484375, 'logits/chosen': 26.440818786621094, 'logits/rejected': 26.217361450195312, 'epoch': 0.32}
{'loss': 0.1462, 'grad_norm': 4.672147274017334, 'learning_rate': 1.4812285573830718e-05, 'rewards/chosen': 1.0324230194091797, 'rewards/rejected': -2.7769768238067627, 'rewards/accuracies': 0.875, 'rewards/margins': 3.8093998432159424, 'logps/chosen': -355.515869140625, 'logps/rejected': -329.3557434082031, 'logits/chosen': 27.141693115234375, 'logits/rejected': 26.18370246887207, 'epoch': 0.35}
{'loss': 0.1412, 'grad_norm': 1.6485308408737183, 'learning_rate': 1.4627250786946213e-05, 'rewards/chosen': 0.9297199249267578, 'rewards/rejected': -3.0341696739196777, 'rewards/accuracies': 0.90625, 'rewards/margins': 3.9638895988464355, 'logps/chosen': -330.87921142578125, 'logps/rejected': -305.3153076171875, 'logits/chosen': 26.629741668701172, 'logits/rejected': 26.12070655822754, 'epoch': 0.38}
{'loss': 0.2314, 'grad_norm': 7.057722568511963, 'learning_rate': 1.4427871859464803e-05, 'rewards/chosen': 0.8209823369979858, 'rewards/rejected': -2.995654821395874, 'rewards/accuracies': 0.9375, 'rewards/margins': 3.8166375160217285, 'logps/chosen': -336.73443603515625, 'logps/rejected': -310.61480712890625, 'logits/chosen': 26.736591339111328, 'logits/rejected': 26.015716552734375, 'epoch': 0.41}
{'loss': 0.4377, 'grad_norm': 44.04376983642578, 'learning_rate': 1.4214574276065485e-05, 'rewards/chosen': 0.9388723373413086, 'rewards/rejected': -2.9990410804748535, 'rewards/accuracies': 0.84375, 'rewards/margins': 3.937913417816162, 'logps/chosen': -300.9297790527344, 'logps/rejected': -303.79412841796875, 'logits/chosen': 26.180192947387695, 'logits/rejected': 25.916748046875, 'epoch': 0.44}
{'loss': 0.2702, 'grad_norm': 12.405875205993652, 'learning_rate': 1.3987813224540415e-05, 'rewards/chosen': 0.6683498024940491, 'rewards/rejected': -3.379523754119873, 'rewards/accuracies': 0.875, 'rewards/margins': 4.047873020172119, 'logps/chosen': -331.9897766113281, 'logps/rejected': -299.66217041015625, 'logits/chosen': 26.53512954711914, 'logits/rejected': 25.65770149230957, 'epoch': 0.47}
{'loss': 0.1393, 'grad_norm': 1.422903060913086, 'learning_rate': 1.3748072624401233e-05, 'rewards/chosen': 0.8914040327072144, 'rewards/rejected': -4.384659290313721, 'rewards/accuracies': 0.84375, 'rewards/margins': 5.276062965393066, 'logps/chosen': -328.0422058105469, 'logps/rejected': -298.76239013671875, 'logits/chosen': 26.533920288085938, 'logits/rejected': 25.961688995361328, 'epoch': 0.5}
{'loss': 0.128, 'grad_norm': 0.7393866181373596, 'learning_rate': 1.3495864094170423e-05, 'rewards/chosen': 1.1513447761535645, 'rewards/rejected': -3.891617774963379, 'rewards/accuracies': 0.875, 'rewards/margins': 5.042963027954102, 'logps/chosen': -326.3845520019531, 'logps/rejected': -313.6087951660156, 'logits/chosen': 26.330358505249023, 'logits/rejected': 25.99002456665039, 'epoch': 0.53}
{'loss': 0.1997, 'grad_norm': 0.9236006140708923, 'learning_rate': 1.3231725859561612e-05, 'rewards/chosen': 1.3764336109161377, 'rewards/rejected': -3.0372581481933594, 'rewards/accuracies': 0.75, 'rewards/margins': 4.413691997528076, 'logps/chosen': -322.16204833984375, 'logps/rejected': -308.65625, 'logits/chosen': 26.41158676147461, 'logits/rejected': 26.063295364379883, 'epoch': 0.56}
{'loss': 0.0851, 'grad_norm': 0.2154809832572937, 'learning_rate': 1.2956221604878768e-05, 'rewards/chosen': 1.9418424367904663, 'rewards/rejected': -4.499175548553467, 'rewards/accuracies': 1.0, 'rewards/margins': 6.441019058227539, 'logps/chosen': -338.98529052734375, 'logps/rejected': -308.23870849609375, 'logits/chosen': 27.089147567749023, 'logits/rejected': 25.65821647644043, 'epoch': 0.59}
{'loss': 0.138, 'grad_norm': 1.733862042427063, 'learning_rate': 1.2669939270085492e-05, 'rewards/chosen': 1.9919990301132202, 'rewards/rejected': -3.912569999694824, 'rewards/accuracies': 0.9375, 'rewards/margins': 5.904569625854492, 'logps/chosen': -318.50750732421875, 'logps/rejected': -303.84405517578125, 'logits/chosen': 26.599580764770508, 'logits/rejected': 25.474130630493164, 'epoch': 0.62}
{'loss': 0.22, 'grad_norm': 1.7399182319641113, 'learning_rate': 1.2373489796111503e-05, 'rewards/chosen': 1.9616777896881104, 'rewards/rejected': -2.9392452239990234, 'rewards/accuracies': 0.84375, 'rewards/margins': 4.900922775268555, 'logps/chosen': -342.00579833984375, 'logps/rejected': -334.88775634765625, 'logits/chosen': 26.747678756713867, 'logits/rejected': 25.971439361572266, 'epoch': 0.65}
{'loss': 0.1523, 'grad_norm': 1.099932074546814, 'learning_rate': 1.206750582107391e-05, 'rewards/chosen': 1.6747244596481323, 'rewards/rejected': -3.808711290359497, 'rewards/accuracies': 0.875, 'rewards/margins': 5.48343563079834, 'logps/chosen': -341.72393798828125, 'logps/rejected': -321.05743408203125, 'logits/chosen': 26.658994674682617, 'logits/rejected': 25.934537887573242, 'epoch': 0.68}
{'loss': 0.2285, 'grad_norm': 2.915397882461548, 'learning_rate': 1.175264033019558e-05, 'rewards/chosen': 2.0775816440582275, 'rewards/rejected': -2.805197238922119, 'rewards/accuracies': 0.875, 'rewards/margins': 4.882779121398926, 'logps/chosen': -296.4333801269531, 'logps/rejected': -303.1094970703125, 'logits/chosen': 25.85393524169922, 'logits/rejected': 25.724536895751953, 'epoch': 0.71}
{'loss': 0.2063, 'grad_norm': 4.23549747467041, 'learning_rate': 1.1429565262301781e-05, 'rewards/chosen': 2.106426239013672, 'rewards/rejected': -3.5653412342071533, 'rewards/accuracies': 0.875, 'rewards/margins': 5.671767234802246, 'logps/chosen': -342.815673828125, 'logps/rejected': -310.1341247558594, 'logits/chosen': 26.637088775634766, 'logits/rejected': 25.9984188079834, 'epoch': 0.74}
{'loss': 0.2652, 'grad_norm': 4.962418556213379, 'learning_rate': 1.1098970075868839e-05, 'rewards/chosen': 1.8375166654586792, 'rewards/rejected': -2.960272789001465, 'rewards/accuracies': 0.8125, 'rewards/margins': 4.797789096832275, 'logps/chosen': -333.7718200683594, 'logps/rejected': -323.14697265625, 'logits/chosen': 26.621234893798828, 'logits/rejected': 25.458011627197266, 'epoch': 0.76}
{'loss': 0.4494, 'grad_norm': 34.80604553222656, 'learning_rate': 1.0761560277685043e-05, 'rewards/chosen': 2.0268969535827637, 'rewards/rejected': -2.6975083351135254, 'rewards/accuracies': 0.6875, 'rewards/margins': 4.724404811859131, 'logps/chosen': -330.6552429199219, 'logps/rejected': -318.61419677734375, 'logits/chosen': 26.54954719543457, 'logits/rejected': 25.66102409362793, 'epoch': 0.79}
{'loss': 0.2256, 'grad_norm': 1.6435377597808838, 'learning_rate': 1.0418055917263557e-05, 'rewards/chosen': 1.7912464141845703, 'rewards/rejected': -3.814270496368408, 'rewards/accuracies': 0.84375, 'rewards/margins': 5.60551643371582, 'logps/chosen': -360.53070068359375, 'logps/rejected': -311.1678771972656, 'logits/chosen': 27.051862716674805, 'logits/rejected': 25.85947608947754, 'epoch': 0.82}
{'loss': 0.1206, 'grad_norm': 1.2982431650161743, 'learning_rate': 1.0069190050220522e-05, 'rewards/chosen': 1.9782825708389282, 'rewards/rejected': -4.785651206970215, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.763934135437012, 'logps/chosen': -322.5747985839844, 'logps/rejected': -293.68487548828125, 'logits/chosen': 26.3247127532959, 'logits/rejected': 25.55172348022461, 'epoch': 0.85}
{'loss': 0.2043, 'grad_norm': 2.797821521759033, 'learning_rate': 9.715707173897384e-06, 'rewards/chosen': 1.944193959236145, 'rewards/rejected': -3.7813994884490967, 'rewards/accuracies': 0.90625, 'rewards/margins': 5.725593566894531, 'logps/chosen': -339.8258056640625, 'logps/rejected': -303.0794677734375, 'logits/chosen': 26.458629608154297, 'logits/rejected': 25.37688636779785, 'epoch': 0.88}
{'loss': 0.1769, 'grad_norm': 3.0884339809417725, 'learning_rate': 9.358361638566079e-06, 'rewards/chosen': 2.5268375873565674, 'rewards/rejected': -4.680400371551514, 'rewards/accuracies': 0.90625, 'rewards/margins': 7.20723819732666, 'logps/chosen': -346.14556884765625, 'logps/rejected': -320.81109619140625, 'logits/chosen': 26.479034423828125, 'logits/rejected': 25.645145416259766, 'epoch': 0.91}
{'loss': 0.1761, 'grad_norm': 0.5785618424415588, 'learning_rate': 8.997916037607525e-06, 'rewards/chosen': 2.0001368522644043, 'rewards/rejected': -4.23991584777832, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.240052223205566, 'logps/chosen': -325.4148254394531, 'logps/rejected': -331.56414794921875, 'logits/chosen': 26.217397689819336, 'logits/rejected': 25.449352264404297, 'epoch': 0.94}
{'loss': 0.1413, 'grad_norm': 2.101154327392578, 'learning_rate': 8.635139580098913e-06, 'rewards/chosen': 1.7974902391433716, 'rewards/rejected': -4.840145587921143, 'rewards/accuracies': 0.875, 'rewards/margins': 6.637635231018066, 'logps/chosen': -343.2493896484375, 'logps/rejected': -315.0487365722656, 'logits/chosen': 26.50210952758789, 'logits/rejected': 25.613651275634766, 'epoch': 0.97}
{'loss': 0.1019, 'grad_norm': 2.8744442462921143, 'learning_rate': 8.27080644928278e-06, 'rewards/chosen': 1.970839500427246, 'rewards/rejected': -5.533916473388672, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.504755973815918, 'logps/chosen': -347.1733703613281, 'logps/rejected': -300.69720458984375, 'logits/chosen': 26.475317001342773, 'logits/rejected': 25.534381866455078, 'epoch': 1.0}
{'loss': 0.2035, 'grad_norm': 1.90916907787323, 'learning_rate': 7.905694150420949e-06, 'rewards/chosen': 1.8223590850830078, 'rewards/rejected': -4.506590366363525, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.328948974609375, 'logps/chosen': -330.3342590332031, 'logps/rejected': -312.0736999511719, 'logits/chosen': 26.40096092224121, 'logits/rejected': 25.77783203125, 'epoch': 1.03}
{'loss': 0.2042, 'grad_norm': 3.4383058547973633, 'learning_rate': 7.5405818515591194e-06, 'rewards/chosen': 1.340904951095581, 'rewards/rejected': -4.754251956939697, 'rewards/accuracies': 0.8125, 'rewards/margins': 6.095157623291016, 'logps/chosen': -328.3115234375, 'logps/rejected': -298.72625732421875, 'logits/chosen': 26.41551971435547, 'logits/rejected': 25.58683967590332, 'epoch': 1.06}
{'loss': 0.2239, 'grad_norm': 3.236154794692993, 'learning_rate': 7.176248720742986e-06, 'rewards/chosen': 1.5722596645355225, 'rewards/rejected': -4.006814002990723, 'rewards/accuracies': 0.90625, 'rewards/margins': 5.579074382781982, 'logps/chosen': -331.9170227050781, 'logps/rejected': -318.1783447265625, 'logits/chosen': 26.384763717651367, 'logits/rejected': 25.91252326965332, 'epoch': 1.09}
{'loss': 0.1654, 'grad_norm': 1.5192501544952393, 'learning_rate': 6.813472263234376e-06, 'rewards/chosen': 1.5531864166259766, 'rewards/rejected': -4.863015651702881, 'rewards/accuracies': 0.8125, 'rewards/margins': 6.416201591491699, 'logps/chosen': -324.5773010253906, 'logps/rejected': -308.5377502441406, 'logits/chosen': 26.54159164428711, 'logits/rejected': 25.47180938720703, 'epoch': 1.12}
{'loss': 0.1294, 'grad_norm': 2.7514636516571045, 'learning_rate': 6.453026662275818e-06, 'rewards/chosen': 1.5389533042907715, 'rewards/rejected': -5.429272651672363, 'rewards/accuracies': 0.96875, 'rewards/margins': 6.968225479125977, 'logps/chosen': -336.44921875, 'logps/rejected': -324.6606750488281, 'logits/chosen': 26.43923568725586, 'logits/rejected': 25.76047706604004, 'epoch': 1.15}
{'loss': 0.1828, 'grad_norm': 8.69691276550293, 'learning_rate': 6.0956811269445166e-06, 'rewards/chosen': 1.2734123468399048, 'rewards/rejected': -5.109914779663086, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.383326530456543, 'logps/chosen': -327.8804931640625, 'logps/rejected': -310.31085205078125, 'logits/chosen': 26.29069709777832, 'logits/rejected': 25.635120391845703, 'epoch': 1.18}
{'loss': 2.7739, 'grad_norm': 500.3324279785156, 'learning_rate': 5.7421982506213775e-06, 'rewards/chosen': 0.9171518087387085, 'rewards/rejected': -6.101703643798828, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.018855094909668, 'logps/chosen': -326.34857177734375, 'logps/rejected': -307.75323486328125, 'logits/chosen': 25.988506317138672, 'logits/rejected': 25.594051361083984, 'epoch': 1.21}
{'loss': 0.3474, 'grad_norm': 52.92344284057617, 'learning_rate': 5.39333238357834e-06, 'rewards/chosen': 0.9539926052093506, 'rewards/rejected': -6.957054615020752, 'rewards/accuracies': 0.96875, 'rewards/margins': 7.911046981811523, 'logps/chosen': -344.6517639160156, 'logps/rejected': -323.8118591308594, 'logits/chosen': 26.47252082824707, 'logits/rejected': 25.418872833251953, 'epoch': 1.24}
{'loss': 0.1408, 'grad_norm': 2.219802141189575, 'learning_rate': 5.049828023156857e-06, 'rewards/chosen': 1.0898630619049072, 'rewards/rejected': -6.018332481384277, 'rewards/accuracies': 0.84375, 'rewards/margins': 7.1081953048706055, 'logps/chosen': -324.54278564453125, 'logps/rejected': -309.9745788574219, 'logits/chosen': 25.866798400878906, 'logits/rejected': 25.687278747558594, 'epoch': 1.26}
{'loss': 0.1651, 'grad_norm': 6.587549209594727, 'learning_rate': 4.712418224973058e-06, 'rewards/chosen': 0.861559271812439, 'rewards/rejected': -6.126524925231934, 'rewards/accuracies': 0.875, 'rewards/margins': 6.988084316253662, 'logps/chosen': -318.64093017578125, 'logps/rejected': -313.83734130859375, 'logits/chosen': 26.117759704589844, 'logits/rejected': 25.503040313720703, 'epoch': 1.29}
{'loss': 0.39, 'grad_norm': 50.36081314086914, 'learning_rate': 4.381823038540119e-06, 'rewards/chosen': 1.5746557712554932, 'rewards/rejected': -5.180098056793213, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.754754543304443, 'logps/chosen': -359.3445129394531, 'logps/rejected': -308.8813781738281, 'logits/chosen': 26.49009895324707, 'logits/rejected': 25.444591522216797, 'epoch': 1.32}
{'loss': 0.4601, 'grad_norm': 50.60694885253906, 'learning_rate': 4.058747970646318e-06, 'rewards/chosen': 1.1925266981124878, 'rewards/rejected': -4.923750400543213, 'rewards/accuracies': 0.8125, 'rewards/margins': 6.11627721786499, 'logps/chosen': -319.1205749511719, 'logps/rejected': -316.86175537109375, 'logits/chosen': 26.101686477661133, 'logits/rejected': 25.63565444946289, 'epoch': 1.35}
{'loss': 0.1531, 'grad_norm': 2.7521088123321533, 'learning_rate': 3.7438824797679878e-06, 'rewards/chosen': 1.548112154006958, 'rewards/rejected': -5.809513568878174, 'rewards/accuracies': 1.0, 'rewards/margins': 7.357626438140869, 'logps/chosen': -322.9012756347656, 'logps/rejected': -340.59136962890625, 'logits/chosen': 26.198598861694336, 'logits/rejected': 25.790206909179688, 'epoch': 1.38}
{'loss': 0.2177, 'grad_norm': 16.229581832885742, 'learning_rate': 3.437898504730395e-06, 'rewards/chosen': 1.526275873184204, 'rewards/rejected': -5.629942893981934, 'rewards/accuracies': 0.875, 'rewards/margins': 7.1562180519104, 'logps/chosen': -334.40203857421875, 'logps/rejected': -312.52203369140625, 'logits/chosen': 26.47934341430664, 'logits/rejected': 25.433486938476562, 'epoch': 1.41}
{'loss': 0.4726, 'grad_norm': 30.463045120239258, 'learning_rate': 3.1414490307564067e-06, 'rewards/chosen': 1.3589099645614624, 'rewards/rejected': -2.989935874938965, 'rewards/accuracies': 0.8125, 'rewards/margins': 4.348845481872559, 'logps/chosen': -301.4351806640625, 'logps/rejected': -304.11962890625, 'logits/chosen': 25.39200210571289, 'logits/rejected': 25.628507614135742, 'epoch': 1.44}
{'loss': 0.3196, 'grad_norm': 13.141144752502441, 'learning_rate': 2.8551666959631317e-06, 'rewards/chosen': 1.673768401145935, 'rewards/rejected': -4.017741680145264, 'rewards/accuracies': 0.875, 'rewards/margins': 5.691509246826172, 'logps/chosen': -342.2484130859375, 'logps/rejected': -316.72296142578125, 'logits/chosen': 25.791851043701172, 'logits/rejected': 25.31220817565918, 'epoch': 1.47}
{'loss': 0.1688, 'grad_norm': 2.8845269680023193, 'learning_rate': 2.5796624412802854e-06, 'rewards/chosen': 1.750694990158081, 'rewards/rejected': -4.776514053344727, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.527209758758545, 'logps/chosen': -338.9852294921875, 'logps/rejected': -323.71630859375, 'logits/chosen': 26.443552017211914, 'logits/rejected': 25.917335510253906, 'epoch': 1.5}
{'loss': 0.2189, 'grad_norm': 2.9536643028259277, 'learning_rate': 2.315524206671475e-06, 'rewards/chosen': 1.7444720268249512, 'rewards/rejected': -4.975672721862793, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.720144271850586, 'logps/chosen': -322.042724609375, 'logps/rejected': -319.42047119140625, 'logits/chosen': 26.41806983947754, 'logits/rejected': 25.50132179260254, 'epoch': 1.53}
{'loss': 0.167, 'grad_norm': 2.4375479221343994, 'learning_rate': 2.063315676440666e-06, 'rewards/chosen': 1.3093891143798828, 'rewards/rejected': -4.501338005065918, 'rewards/accuracies': 0.8125, 'rewards/margins': 5.810727119445801, 'logps/chosen': -323.20562744140625, 'logps/rejected': -318.557373046875, 'logits/chosen': 26.02806854248047, 'logits/rejected': 25.775144577026367, 'epoch': 1.56}
{'loss': 0.2068, 'grad_norm': 7.499303817749023, 'learning_rate': 1.823575076301483e-06, 'rewards/chosen': 1.7107115983963013, 'rewards/rejected': -4.8643975257873535, 'rewards/accuracies': 0.875, 'rewards/margins': 6.575109004974365, 'logps/chosen': -331.8534240722656, 'logps/rejected': -329.6092224121094, 'logits/chosen': 26.225364685058594, 'logits/rejected': 26.00411605834961, 'epoch': 1.59}
{'loss': 0.2723, 'grad_norm': 13.770828247070312, 'learning_rate': 1.5968140247764147e-06, 'rewards/chosen': 1.395565152168274, 'rewards/rejected': -4.837512016296387, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.233077049255371, 'logps/chosen': -318.28314208984375, 'logps/rejected': -313.7330017089844, 'logits/chosen': 26.193069458007812, 'logits/rejected': 25.68631362915039, 'epoch': 1.62}
{'loss': 0.2243, 'grad_norm': 1.514216423034668, 'learning_rate': 1.3835164413770959e-06, 'rewards/chosen': 1.699552059173584, 'rewards/rejected': -4.719710350036621, 'rewards/accuracies': 0.8125, 'rewards/margins': 6.419261932373047, 'logps/chosen': -327.31396484375, 'logps/rejected': -309.9791259765625, 'logits/chosen': 26.079648971557617, 'logits/rejected': 25.71605682373047, 'epoch': 1.65}
{'loss': 0.166, 'grad_norm': 2.6605982780456543, 'learning_rate': 1.1841375138956855e-06, 'rewards/chosen': 1.8416861295700073, 'rewards/rejected': -5.308895587921143, 'rewards/accuracies': 0.84375, 'rewards/margins': 7.150581359863281, 'logps/chosen': -327.14654541015625, 'logps/rejected': -300.0340881347656, 'logits/chosen': 26.04876708984375, 'logits/rejected': 25.721317291259766, 'epoch': 1.68}
{'loss': 0.1572, 'grad_norm': 2.169330596923828, 'learning_rate': 9.991027270111806e-07, 'rewards/chosen': 1.8305113315582275, 'rewards/rejected': -5.140588283538818, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.971099853515625, 'logps/chosen': -335.1445617675781, 'logps/rejected': -321.50433349609375, 'logits/chosen': 26.538389205932617, 'logits/rejected': 26.0445556640625, 'epoch': 1.71}
{'loss': 0.0701, 'grad_norm': 0.9183354377746582, 'learning_rate': 8.288069542836699e-07, 'rewards/chosen': 1.6957581043243408, 'rewards/rejected': -6.229953289031982, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.925710678100586, 'logps/chosen': -329.49652099609375, 'logps/rejected': -315.88397216796875, 'logits/chosen': 26.199764251708984, 'logits/rejected': 25.49576187133789, 'epoch': 1.74}
{'loss': 0.1495, 'grad_norm': 0.4776802659034729, 'learning_rate': 6.736136154742503e-07, 'rewards/chosen': 1.8456182479858398, 'rewards/rejected': -5.5091047286987305, 'rewards/accuracies': 0.9375, 'rewards/margins': 7.35472297668457, 'logps/chosen': -326.7897644042969, 'logps/rejected': -330.398681640625, 'logits/chosen': 26.14582061767578, 'logits/rejected': 25.393028259277344, 'epoch': 1.76}
{'loss': 0.1618, 'grad_norm': 2.398399829864502, 'learning_rate': 5.338539009889528e-07, 'rewards/chosen': 1.4775505065917969, 'rewards/rejected': -4.925861835479736, 'rewards/accuracies': 0.90625, 'rewards/margins': 6.403412818908691, 'logps/chosen': -334.332275390625, 'logps/rejected': -309.73785400390625, 'logits/chosen': 26.417129516601562, 'logits/rejected': 25.584699630737305, 'epoch': 1.79}
{'loss': 0.4743, 'grad_norm': 75.08568572998047, 'learning_rate': 4.098260651017114e-07, 'rewards/chosen': 1.710526943206787, 'rewards/rejected': -5.879210948944092, 'rewards/accuracies': 0.875, 'rewards/margins': 7.589737415313721, 'logps/chosen': -337.56341552734375, 'logps/rejected': -327.0181884765625, 'logits/chosen': 26.255266189575195, 'logits/rejected': 25.429969787597656, 'epoch': 1.82}
{'loss': 0.2243, 'grad_norm': 1.5214520692825317, 'learning_rate': 3.017947894647265e-07, 'rewards/chosen': 1.6736187934875488, 'rewards/rejected': -4.499320983886719, 'rewards/accuracies': 0.84375, 'rewards/margins': 6.172940254211426, 'logps/chosen': -332.4306335449219, 'logps/rejected': -302.1231384277344, 'logits/chosen': 26.19358253479004, 'logits/rejected': 25.42488670349121, 'epoch': 1.85}
{'loss': 0.0585, 'grad_norm': 1.0241098403930664, 'learning_rate': 2.099906182644697e-07, 'rewards/chosen': 1.7120726108551025, 'rewards/rejected': -6.404486656188965, 'rewards/accuracies': 1.0, 'rewards/margins': 8.116559028625488, 'logps/chosen': -337.85321044921875, 'logps/rejected': -302.64569091796875, 'logits/chosen': 26.76832389831543, 'logits/rejected': 25.361927032470703, 'epoch': 1.88}
{'loss': 0.1618, 'grad_norm': 1.3581573963165283, 'learning_rate': 1.3460946622877826e-07, 'rewards/chosen': 1.9872348308563232, 'rewards/rejected': -4.917462348937988, 'rewards/accuracies': 0.9375, 'rewards/margins': 6.904697418212891, 'logps/chosen': -319.432861328125, 'logps/rejected': -342.7939758300781, 'logits/chosen': 26.2525634765625, 'logits/rejected': 25.74225425720215, 'epoch': 1.91}
{'loss': 0.2249, 'grad_norm': 6.395023822784424, 'learning_rate': 7.581220053494852e-08, 'rewards/chosen': 1.4300063848495483, 'rewards/rejected': -4.541739463806152, 'rewards/accuracies': 0.875, 'rewards/margins': 5.971745491027832, 'logps/chosen': -332.2248840332031, 'logps/rejected': -323.37066650390625, 'logits/chosen': 26.463930130004883, 'logits/rejected': 25.69898796081543, 'epoch': 1.94}
{'loss': 0.1078, 'grad_norm': 0.08450718224048615, 'learning_rate': 3.372429751107303e-08, 'rewards/chosen': 2.029088258743286, 'rewards/rejected': -5.999514579772949, 'rewards/accuracies': 0.90625, 'rewards/margins': 8.028602600097656, 'logps/chosen': -326.44903564453125, 'logps/rejected': -311.3084411621094, 'logits/chosen': 26.2398738861084, 'logits/rejected': 25.304264068603516, 'epoch': 1.97}
{'loss': 0.2118, 'grad_norm': 1.7494404315948486, 'learning_rate': 8.435574863236117e-09, 'rewards/chosen': 1.8866982460021973, 'rewards/rejected': -4.590206623077393, 'rewards/accuracies': 0.8125, 'rewards/margins': 6.47690486907959, 'logps/chosen': -340.7392578125, 'logps/rejected': -312.38739013671875, 'logits/chosen': 26.125720977783203, 'logits/rejected': 25.21576499938965, 'epoch': 2.0}
{'train_runtime': 2931.1875, 'train_samples_per_second': 0.742, 'train_steps_per_second': 0.023, 'train_loss': 0.2778759031173061, 'epoch': 2.0}
Unloading and merging model: 100%|██████████| 519/519 [00:00<00:00, 2845.96it/s]
