Finetuning score threshold: -549.2
Learning rate before schedule: 1e-05
Learning rate after schedule: 9.12870929175277e-06
Finetuning with 1439 chats
Extracting prompt in train dataset: 100%|██████████| 1439/1439 [00:00<00:00, 5099.54 examples/s]
Applying chat template to train dataset: 100%|██████████| 1439/1439 [00:00<00:00, 2929.79 examples/s]
Tokenizing train dataset: 100%|██████████| 1439/1439 [00:04<00:00, 309.83 examples/s]
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 1}.
                                               
{'loss': 0.6931, 'grad_norm': 31.484960556030273, 'learning_rate': 9.12870929175277e-06, 'rewards/chosen': 0.0, 'rewards/rejected': 0.0, 'rewards/accuracies': 0.0, 'rewards/margins': 0.0, 'logps/chosen': -289.8609924316406, 'logps/rejected': -303.9039611816406, 'logits/chosen': -7.421098709106445, 'logits/rejected': -7.58756160736084, 'epoch': 0.02}
{'loss': 0.8521, 'grad_norm': 135.3284454345703, 'learning_rate': 9.125928810227238e-06, 'rewards/chosen': -0.03135259449481964, 'rewards/rejected': -0.039600275456905365, 'rewards/accuracies': 0.4375, 'rewards/margins': 0.008247683756053448, 'logps/chosen': -225.5260772705078, 'logps/rejected': -261.23052978515625, 'logits/chosen': -7.573176860809326, 'logits/rejected': -7.602612495422363, 'epoch': 0.04}
{'loss': 0.6972, 'grad_norm': 40.88246154785156, 'learning_rate': 9.117590753239076e-06, 'rewards/chosen': 0.13278813660144806, 'rewards/rejected': 0.09595684707164764, 'rewards/accuracies': 0.53125, 'rewards/margins': 0.036831289529800415, 'logps/chosen': -239.96286010742188, 'logps/rejected': -278.1775817871094, 'logits/chosen': -7.4482574462890625, 'logits/rejected': -7.59920597076416, 'epoch': 0.07}
{'loss': 0.5904, 'grad_norm': 31.78020668029785, 'learning_rate': 9.103705279426351e-06, 'rewards/chosen': 0.2711876332759857, 'rewards/rejected': 0.025618648156523705, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.24556897580623627, 'logps/chosen': -298.5545654296875, 'logps/rejected': -288.0816345214844, 'logits/chosen': -7.4622931480407715, 'logits/rejected': -7.525892734527588, 'epoch': 0.09}
{'loss': 0.6453, 'grad_norm': 27.6385555267334, 'learning_rate': 9.084289306100006e-06, 'rewards/chosen': 0.2918895184993744, 'rewards/rejected': 0.14628081023693085, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.14560870826244354, 'logps/chosen': -279.3507080078125, 'logps/rejected': -294.85736083984375, 'logits/chosen': -7.534900188446045, 'logits/rejected': -7.685988903045654, 'epoch': 0.11}
{'loss': 0.6562, 'grad_norm': 27.965797424316406, 'learning_rate': 9.05936648863274e-06, 'rewards/chosen': 0.2895071804523468, 'rewards/rejected': 0.15339317917823792, 'rewards/accuracies': 0.625, 'rewards/margins': 0.13611404597759247, 'logps/chosen': -274.28045654296875, 'logps/rejected': -262.0637512207031, 'logits/chosen': -7.407338619232178, 'logits/rejected': -7.56685209274292, 'epoch': 0.13}
{'loss': 0.705, 'grad_norm': 50.74403762817383, 'learning_rate': 9.02896719163857e-06, 'rewards/chosen': 0.3850477933883667, 'rewards/rejected': 0.2765134572982788, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.10853436589241028, 'logps/chosen': -304.2102966308594, 'logps/rejected': -292.75299072265625, 'logits/chosen': -7.47412109375, 'logits/rejected': -7.500851154327393, 'epoch': 0.16}
{'loss': 0.7344, 'grad_norm': 76.86112976074219, 'learning_rate': 8.99312845197823e-06, 'rewards/chosen': 0.3455568552017212, 'rewards/rejected': 0.2271895408630371, 'rewards/accuracies': 0.5625, 'rewards/margins': 0.11836730688810349, 'logps/chosen': -302.520751953125, 'logps/rejected': -283.07763671875, 'logits/chosen': -7.538514137268066, 'logits/rejected': -7.625539302825928, 'epoch': 0.18}
{'loss': 0.7531, 'grad_norm': 227.32797241210938, 'learning_rate': 8.951893933635463e-06, 'rewards/chosen': 0.4110047519207001, 'rewards/rejected': 0.22532692551612854, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.18567782640457153, 'logps/chosen': -318.2806701660156, 'logps/rejected': -286.5029296875, 'logits/chosen': -7.413747310638428, 'logits/rejected': -7.599026679992676, 'epoch': 0.2}
{'loss': 0.6215, 'grad_norm': 21.015119552612305, 'learning_rate': 8.905313874519178e-06, 'rewards/chosen': 0.8237498998641968, 'rewards/rejected': 0.4090287983417511, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.4147211015224457, 'logps/chosen': -249.63304138183594, 'logps/rejected': -261.3998718261719, 'logits/chosen': -7.6378560066223145, 'logits/rejected': -7.620826244354248, 'epoch': 0.22}
{'loss': 0.7639, 'grad_norm': 71.47386932373047, 'learning_rate': 8.853445025256302e-06, 'rewards/chosen': 0.47912096977233887, 'rewards/rejected': 0.46849775314331055, 'rewards/accuracies': 0.53125, 'rewards/margins': 0.01062319427728653, 'logps/chosen': -260.33843994140625, 'logps/rejected': -291.0105285644531, 'logits/chosen': -7.546154975891113, 'logits/rejected': -7.509557247161865, 'epoch': 0.24}
{'loss': 0.6249, 'grad_norm': 21.993824005126953, 'learning_rate': 8.796350580049876e-06, 'rewards/chosen': 0.6626830101013184, 'rewards/rejected': 0.3930528163909912, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.2696301341056824, 'logps/chosen': -254.1498260498047, 'logps/rejected': -300.261962890625, 'logits/chosen': -7.596198081970215, 'logits/rejected': -7.612202167510986, 'epoch': 0.27}
{'loss': 0.6143, 'grad_norm': 21.886695861816406, 'learning_rate': 8.734100099686657e-06, 'rewards/chosen': 0.7114903926849365, 'rewards/rejected': 0.39579498767852783, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.3156954050064087, 'logps/chosen': -293.0807800292969, 'logps/rejected': -311.7588195800781, 'logits/chosen': -7.513213157653809, 'logits/rejected': -7.438681602478027, 'epoch': 0.29}
{'loss': 0.5386, 'grad_norm': 31.57767105102539, 'learning_rate': 8.666769426788021e-06, 'rewards/chosen': 0.6847460269927979, 'rewards/rejected': 0.12733736634254456, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.5574087500572205, 'logps/chosen': -290.6031799316406, 'logps/rejected': -304.64996337890625, 'logits/chosen': -7.5055341720581055, 'logits/rejected': -7.496981143951416, 'epoch': 0.31}
{'loss': 0.7434, 'grad_norm': 186.7428436279297, 'learning_rate': 8.5944405934074e-06, 'rewards/chosen': 0.681888222694397, 'rewards/rejected': 0.1373961716890335, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.5444920063018799, 'logps/chosen': -268.6729431152344, 'logps/rejected': -319.2557678222656, 'logits/chosen': -7.502204418182373, 'logits/rejected': -7.551480293273926, 'epoch': 0.33}
{'loss': 0.5852, 'grad_norm': 55.723270416259766, 'learning_rate': 8.517201721086861e-06, 'rewards/chosen': 0.577555239200592, 'rewards/rejected': 0.01680675894021988, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.5607483983039856, 'logps/chosen': -253.03968811035156, 'logps/rejected': -215.08355712890625, 'logits/chosen': -7.637033939361572, 'logits/rejected': -7.73217248916626, 'epoch': 0.36}
{'loss': 0.4145, 'grad_norm': 39.213043212890625, 'learning_rate': 8.43514691349459e-06, 'rewards/chosen': 0.5483975410461426, 'rewards/rejected': -0.12605342268943787, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.6744509339332581, 'logps/chosen': -266.79998779296875, 'logps/rejected': -281.7496337890625, 'logits/chosen': -7.416784763336182, 'logits/rejected': -7.512541770935059, 'epoch': 0.38}
{'loss': 0.4441, 'grad_norm': 37.98458480834961, 'learning_rate': 8.34837614177407e-06, 'rewards/chosen': 0.7080686092376709, 'rewards/rejected': -0.19111233949661255, 'rewards/accuracies': 0.875, 'rewards/margins': 0.8991809487342834, 'logps/chosen': -254.81553649902344, 'logps/rejected': -275.6960144042969, 'logits/chosen': -7.586458683013916, 'logits/rejected': -7.557687282562256, 'epoch': 0.4}
{'loss': 1.4739, 'grad_norm': 590.3302001953125, 'learning_rate': 8.256995122744626e-06, 'rewards/chosen': 0.18312373757362366, 'rewards/rejected': -0.2924782633781433, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.47560203075408936, 'logps/chosen': -266.40606689453125, 'logps/rejected': -311.06549072265625, 'logits/chosen': -7.540849208831787, 'logits/rejected': -7.528805732727051, 'epoch': 0.42}
{'loss': 1.1438, 'grad_norm': 372.2666320800781, 'learning_rate': 8.161115190101776e-06, 'rewards/chosen': 0.27127233147621155, 'rewards/rejected': -0.2737332880496979, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.5450055599212646, 'logps/chosen': -251.88067626953125, 'logps/rejected': -258.27349853515625, 'logits/chosen': -7.56220817565918, 'logits/rejected': -7.578773021697998, 'epoch': 0.44}
{'loss': 0.6285, 'grad_norm': 130.61732482910156, 'learning_rate': 8.06085315877428e-06, 'rewards/chosen': 0.31229451298713684, 'rewards/rejected': -0.364828884601593, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.6771234273910522, 'logps/chosen': -275.5204162597656, 'logps/rejected': -319.13775634765625, 'logits/chosen': -7.6596550941467285, 'logits/rejected': -7.565873146057129, 'epoch': 0.47}
{'loss': 0.427, 'grad_norm': 60.66978073120117, 'learning_rate': 7.956331182603124e-06, 'rewards/chosen': 0.5482327938079834, 'rewards/rejected': -0.48729634284973145, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.0355292558670044, 'logps/chosen': -290.32373046875, 'logps/rejected': -303.20361328125, 'logits/chosen': -7.541991233825684, 'logits/rejected': -7.611181735992432, 'epoch': 0.49}
{'loss': 0.6237, 'grad_norm': 83.94696807861328, 'learning_rate': 7.847676605515897e-06, 'rewards/chosen': 0.7490012645721436, 'rewards/rejected': 0.0196757260710001, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.729325532913208, 'logps/chosen': -233.5393829345703, 'logps/rejected': -251.8192596435547, 'logits/chosen': -7.373512268066406, 'logits/rejected': -7.475720405578613, 'epoch': 0.51}
{'loss': 0.6033, 'grad_norm': 66.25625610351562, 'learning_rate': 7.735021806377828e-06, 'rewards/chosen': 0.5547267198562622, 'rewards/rejected': -0.05684908106923103, 'rewards/accuracies': 0.65625, 'rewards/margins': 0.611575722694397, 'logps/chosen': -287.7796936035156, 'logps/rejected': -280.37799072265625, 'logits/chosen': -7.5299601554870605, 'logits/rejected': -7.558258533477783, 'epoch': 0.53}
{'loss': 0.6061, 'grad_norm': 106.03089141845703, 'learning_rate': 7.618504037708522e-06, 'rewards/chosen': 0.7441005706787109, 'rewards/rejected': 0.17158380150794983, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.572516679763794, 'logps/chosen': -273.27362060546875, 'logps/rejected': -272.86572265625, 'logits/chosen': -7.533604621887207, 'logits/rejected': -7.493824481964111, 'epoch': 0.56}
{'loss': 0.7791, 'grad_norm': 320.5229797363281, 'learning_rate': 7.498265258460916e-06, 'rewards/chosen': 0.8033050298690796, 'rewards/rejected': -0.01245969533920288, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.8157647848129272, 'logps/chosen': -301.9497375488281, 'logps/rejected': -298.98004150390625, 'logits/chosen': -7.606845855712891, 'logits/rejected': -7.683605194091797, 'epoch': 0.58}
{'loss': 0.497, 'grad_norm': 38.44063949584961, 'learning_rate': 7.374451961066162e-06, 'rewards/chosen': 1.0287349224090576, 'rewards/rejected': -0.060510311275720596, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.0892452001571655, 'logps/chosen': -305.14013671875, 'logps/rejected': -308.8695373535156, 'logits/chosen': -7.4975762367248535, 'logits/rejected': -7.566611289978027, 'epoch': 0.6}
{'loss': 0.51, 'grad_norm': 25.554521560668945, 'learning_rate': 7.2472149929551576e-06, 'rewards/chosen': 1.249901533126831, 'rewards/rejected': 0.19761069118976593, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.052290916442871, 'logps/chosen': -284.3089904785156, 'logps/rejected': -298.3607177734375, 'logits/chosen': -7.599276542663574, 'logits/rejected': -7.583020210266113, 'epoch': 0.62}
{'loss': 0.5217, 'grad_norm': 38.845218658447266, 'learning_rate': 7.116709372774193e-06, 'rewards/chosen': 1.208847999572754, 'rewards/rejected': 0.32187753915786743, 'rewards/accuracies': 0.8125, 'rewards/margins': 0.8869704604148865, 'logps/chosen': -243.73651123046875, 'logps/rejected': -277.7003173828125, 'logits/chosen': -7.632176399230957, 'logits/rejected': -7.494612693786621, 'epoch': 0.64}
{'loss': 0.5564, 'grad_norm': 20.477027893066406, 'learning_rate': 6.983094101518609e-06, 'rewards/chosen': 1.2230942249298096, 'rewards/rejected': 0.4784657061100006, 'rewards/accuracies': 0.75, 'rewards/margins': 0.7446284890174866, 'logps/chosen': -254.58335876464844, 'logps/rejected': -296.3883972167969, 'logits/chosen': -7.526291847229004, 'logits/rejected': -7.71043586730957, 'epoch': 0.67}
{'loss': 0.6438, 'grad_norm': 24.409595489501953, 'learning_rate': 6.846531968814577e-06, 'rewards/chosen': 1.0494670867919922, 'rewards/rejected': 0.6156134009361267, 'rewards/accuracies': 0.59375, 'rewards/margins': 0.4338536560535431, 'logps/chosen': -272.9842834472656, 'logps/rejected': -295.2054138183594, 'logits/chosen': -7.644734859466553, 'logits/rejected': -7.622000217437744, 'epoch': 0.69}
{'loss': 0.3968, 'grad_norm': 20.519760131835938, 'learning_rate': 6.707189354585012e-06, 'rewards/chosen': 1.1757335662841797, 'rewards/rejected': -0.18741828203201294, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.3631517887115479, 'logps/chosen': -243.98782348632812, 'logps/rejected': -302.284912109375, 'logits/chosen': -7.486100196838379, 'logits/rejected': -7.653114318847656, 'epoch': 0.71}
{'loss': 0.717, 'grad_norm': 126.45872497558594, 'learning_rate': 6.565236026341269e-06, 'rewards/chosen': 1.3228484392166138, 'rewards/rejected': 0.46565794944763184, 'rewards/accuracies': 0.75, 'rewards/margins': 0.8571904897689819, 'logps/chosen': -237.22427368164062, 'logps/rejected': -276.34295654296875, 'logits/chosen': -7.464785575866699, 'logits/rejected': -7.719945907592773, 'epoch': 0.73}
{'loss': 0.5869, 'grad_norm': 74.29700469970703, 'learning_rate': 6.420844932347579e-06, 'rewards/chosen': 0.8579239249229431, 'rewards/rejected': 0.008167266845703125, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.8497565984725952, 'logps/chosen': -313.384033203125, 'logps/rejected': -289.8052673339844, 'logits/chosen': -7.448081970214844, 'logits/rejected': -7.56618070602417, 'epoch': 0.76}
{'loss': 0.4825, 'grad_norm': 81.14894104003906, 'learning_rate': 6.274191990910229e-06, 'rewards/chosen': 0.8915145993232727, 'rewards/rejected': -0.210645392537117, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.1021599769592285, 'logps/chosen': -280.72674560546875, 'logps/rejected': -323.5797119140625, 'logits/chosen': -7.584052085876465, 'logits/rejected': -7.56372594833374, 'epoch': 0.78}
{'loss': 1.0474, 'grad_norm': 457.54827880859375, 'learning_rate': 6.1254558760482085e-06, 'rewards/chosen': 0.7345252633094788, 'rewards/rejected': -0.11899317055940628, 'rewards/accuracies': 0.90625, 'rewards/margins': 0.8535184860229492, 'logps/chosen': -292.6926574707031, 'logps/rejected': -303.90887451171875, 'logits/chosen': -7.609617710113525, 'logits/rejected': -7.580853462219238, 'epoch': 0.8}
{'loss': 0.6209, 'grad_norm': 170.02957153320312, 'learning_rate': 5.974817799806433e-06, 'rewards/chosen': 0.7071604132652283, 'rewards/rejected': -0.3343411684036255, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.0415016412734985, 'logps/chosen': -280.67730712890625, 'logps/rejected': -285.643798828125, 'logits/chosen': -7.528689384460449, 'logits/rejected': -7.68920373916626, 'epoch': 0.82}
{'loss': 0.3634, 'grad_norm': 31.164888381958008, 'learning_rate': 5.822461291476786e-06, 'rewards/chosen': 0.7762851715087891, 'rewards/rejected': -0.5777761936187744, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.354061245918274, 'logps/chosen': -262.4661865234375, 'logps/rejected': -278.68109130859375, 'logits/chosen': -7.646048545837402, 'logits/rejected': -7.729645729064941, 'epoch': 0.85}
{'loss': 1.2442, 'grad_norm': 1182.455810546875, 'learning_rate': 5.668571973995949e-06, 'rewards/chosen': 0.6073123812675476, 'rewards/rejected': -0.28322702646255493, 'rewards/accuracies': 0.78125, 'rewards/margins': 0.8905394077301025, 'logps/chosen': -255.27220153808594, 'logps/rejected': -252.25791931152344, 'logits/chosen': -7.39568567276001, 'logits/rejected': -7.572807312011719, 'epoch': 0.87}
{'loss': 1.0655, 'grad_norm': 514.1122436523438, 'learning_rate': 5.513337337792439e-06, 'rewards/chosen': 0.3177672028541565, 'rewards/rejected': -0.528452455997467, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.8462196588516235, 'logps/chosen': -273.93853759765625, 'logps/rejected': -281.682861328125, 'logits/chosen': -7.616109848022461, 'logits/rejected': -7.613323211669922, 'epoch': 0.89}
{'loss': 0.689, 'grad_norm': 206.87547302246094, 'learning_rate': 5.356946512358407e-06, 'rewards/chosen': 0.6719771027565002, 'rewards/rejected': -0.286352276802063, 'rewards/accuracies': 0.71875, 'rewards/margins': 0.9583293795585632, 'logps/chosen': -265.10968017578125, 'logps/rejected': -297.722900390625, 'logits/chosen': -7.583654880523682, 'logits/rejected': -7.605853080749512, 'epoch': 0.91}
{'loss': 0.4299, 'grad_norm': 62.076133728027344, 'learning_rate': 5.199590035824482e-06, 'rewards/chosen': 0.520698606967926, 'rewards/rejected': -0.5849071145057678, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.1056057214736938, 'logps/chosen': -268.79400634765625, 'logps/rejected': -303.74749755859375, 'logits/chosen': -7.473885536193848, 'logits/rejected': -7.626523971557617, 'epoch': 0.93}
{'loss': 0.517, 'grad_norm': 108.81661987304688, 'learning_rate': 5.041459622818418e-06, 'rewards/chosen': 0.8664348721504211, 'rewards/rejected': -0.3633156716823578, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.229750633239746, 'logps/chosen': -274.3990478515625, 'logps/rejected': -300.6065979003906, 'logits/chosen': -7.5170135498046875, 'logits/rejected': -7.586532115936279, 'epoch': 0.96}
{'loss': 0.3638, 'grad_norm': 33.191741943359375, 'learning_rate': 4.8827479308903365e-06, 'rewards/chosen': 0.8002379536628723, 'rewards/rejected': -0.5431032180786133, 'rewards/accuracies': 0.875, 'rewards/margins': 1.34334135055542, 'logps/chosen': -283.0007019042969, 'logps/rejected': -301.8663330078125, 'logits/chosen': -7.611710548400879, 'logits/rejected': -7.70554256439209, 'epoch': 0.98}
{'loss': 0.3744, 'grad_norm': 23.351472854614258, 'learning_rate': 4.723648325789193e-06, 'rewards/chosen': 1.051304578781128, 'rewards/rejected': -0.2545372545719147, 'rewards/accuracies': 0.9032257795333862, 'rewards/margins': 1.3058418035507202, 'logps/chosen': -228.15292358398438, 'logps/rejected': -226.5910186767578, 'logits/chosen': -7.5655012130737305, 'logits/rejected': -7.624609470367432, 'epoch': 1.0}
{'loss': 0.4162, 'grad_norm': 26.95262908935547, 'learning_rate': 4.564354645876385e-06, 'rewards/chosen': 0.7431843280792236, 'rewards/rejected': -0.49620914459228516, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.2393934726715088, 'logps/chosen': -296.654052734375, 'logps/rejected': -310.8669738769531, 'logits/chosen': -7.50284481048584, 'logits/rejected': -7.577740669250488, 'epoch': 1.02}
{'loss': 0.3409, 'grad_norm': 24.981557846069336, 'learning_rate': 4.405060965963578e-06, 'rewards/chosen': 0.7173514366149902, 'rewards/rejected': -0.5977112054824829, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.3150626420974731, 'logps/chosen': -235.57383728027344, 'logps/rejected': -286.7672119140625, 'logits/chosen': -7.596671104431152, 'logits/rejected': -7.637033462524414, 'epoch': 1.04}
{'loss': 0.2902, 'grad_norm': 29.569501876831055, 'learning_rate': 4.245961360862432e-06, 'rewards/chosen': 0.48872363567352295, 'rewards/rejected': -0.7700251340866089, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.2587487697601318, 'logps/chosen': -267.15179443359375, 'logps/rejected': -301.39251708984375, 'logits/chosen': -7.467924118041992, 'logits/rejected': -7.579552173614502, 'epoch': 1.07}
{'loss': 0.389, 'grad_norm': 42.78923416137695, 'learning_rate': 4.0872496689343525e-06, 'rewards/chosen': 0.599575936794281, 'rewards/rejected': -0.3972180485725403, 'rewards/accuracies': 0.90625, 'rewards/margins': 0.9967938661575317, 'logps/chosen': -273.8045654296875, 'logps/rejected': -309.8166198730469, 'logits/chosen': -7.5308613777160645, 'logits/rejected': -7.474853515625, 'epoch': 1.09}
{'loss': 0.4087, 'grad_norm': 41.14200973510742, 'learning_rate': 3.929119255928288e-06, 'rewards/chosen': 0.6146409511566162, 'rewards/rejected': -0.49287232756614685, 'rewards/accuracies': 0.71875, 'rewards/margins': 1.107513189315796, 'logps/chosen': -263.9718933105469, 'logps/rejected': -286.5988464355469, 'logits/chosen': -7.6818952560424805, 'logits/rejected': -7.724169731140137, 'epoch': 1.11}
{'loss': 0.2427, 'grad_norm': 22.736230850219727, 'learning_rate': 3.7717627793943635e-06, 'rewards/chosen': 0.9352700710296631, 'rewards/rejected': -0.9674155116081238, 'rewards/accuracies': 1.0, 'rewards/margins': 1.9026856422424316, 'logps/chosen': -285.9170227050781, 'logps/rejected': -256.75421142578125, 'logits/chosen': -7.537363529205322, 'logits/rejected': -7.6221418380737305, 'epoch': 1.13}
{'loss': 0.5269, 'grad_norm': 176.74838256835938, 'learning_rate': 3.615371953960331e-06, 'rewards/chosen': 0.44498562812805176, 'rewards/rejected': -0.8272970914840698, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.2722828388214111, 'logps/chosen': -312.49945068359375, 'logps/rejected': -320.4454650878906, 'logits/chosen': -7.409909248352051, 'logits/rejected': -7.4862895011901855, 'epoch': 1.16}
{'loss': 0.4934, 'grad_norm': 132.03375244140625, 'learning_rate': 3.4601373177568204e-06, 'rewards/chosen': 0.47874146699905396, 'rewards/rejected': -0.6664589643478394, 'rewards/accuracies': 0.75, 'rewards/margins': 1.145200490951538, 'logps/chosen': -263.1700134277344, 'logps/rejected': -297.12554931640625, 'logits/chosen': -7.594250679016113, 'logits/rejected': -7.535455703735352, 'epoch': 1.18}
{'loss': 0.1964, 'grad_norm': 28.882749557495117, 'learning_rate': 3.3062480002759827e-06, 'rewards/chosen': 0.4439038634300232, 'rewards/rejected': -1.071802020072937, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.5157058238983154, 'logps/chosen': -289.48663330078125, 'logps/rejected': -293.2840270996094, 'logits/chosen': -7.530622482299805, 'logits/rejected': -7.6524658203125, 'epoch': 1.2}
{'loss': 0.3757, 'grad_norm': 143.5918426513672, 'learning_rate': 3.153891491946337e-06, 'rewards/chosen': 0.2153683304786682, 'rewards/rejected': -0.8944298624992371, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.1097981929779053, 'logps/chosen': -260.53692626953125, 'logps/rejected': -293.1354675292969, 'logits/chosen': -7.644922733306885, 'logits/rejected': -7.53420877456665, 'epoch': 1.22}
{'loss': 0.3324, 'grad_norm': 38.16707992553711, 'learning_rate': 3.0032534157045622e-06, 'rewards/chosen': 0.561901330947876, 'rewards/rejected': -0.9276391267776489, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.4895403385162354, 'logps/chosen': -299.78729248046875, 'logps/rejected': -295.1805114746094, 'logits/chosen': -7.5318379402160645, 'logits/rejected': -7.690196990966797, 'epoch': 1.24}
{'loss': 0.2968, 'grad_norm': 39.92572021484375, 'learning_rate': 2.8545173008425407e-06, 'rewards/chosen': 0.6998976469039917, 'rewards/rejected': -0.6560711860656738, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3559688329696655, 'logps/chosen': -259.8366394042969, 'logps/rejected': -284.47784423828125, 'logits/chosen': -7.451385498046875, 'logits/rejected': -7.439289569854736, 'epoch': 1.27}
{'loss': 0.2542, 'grad_norm': 99.22274780273438, 'learning_rate': 2.707864359405192e-06, 'rewards/chosen': 0.4632982611656189, 'rewards/rejected': -1.3075058460235596, 'rewards/accuracies': 0.875, 'rewards/margins': 1.7708039283752441, 'logps/chosen': -256.4186706542969, 'logps/rejected': -286.93902587890625, 'logits/chosen': -7.654870510101318, 'logits/rejected': -7.797050476074219, 'epoch': 1.29}
{'loss': 0.1541, 'grad_norm': 16.93033790588379, 'learning_rate': 2.5634732654115e-06, 'rewards/chosen': 0.425690621137619, 'rewards/rejected': -1.4437141418457031, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.8694047927856445, 'logps/chosen': -281.6936340332031, 'logps/rejected': -270.7083435058594, 'logits/chosen': -7.44463586807251, 'logits/rejected': -7.559009075164795, 'epoch': 1.31}
{'loss': 0.5786, 'grad_norm': 290.7483825683594, 'learning_rate': 2.4215199371677585e-06, 'rewards/chosen': 0.4245920777320862, 'rewards/rejected': -0.9201604127883911, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.344752550125122, 'logps/chosen': -280.1625061035156, 'logps/rejected': -319.04046630859375, 'logits/chosen': -7.454581260681152, 'logits/rejected': -7.56854772567749, 'epoch': 1.33}
{'loss': 0.2352, 'grad_norm': 41.8212776184082, 'learning_rate': 2.2821773229381932e-06, 'rewards/chosen': 0.40330204367637634, 'rewards/rejected': -1.0074243545532227, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.4107264280319214, 'logps/chosen': -247.78138732910156, 'logps/rejected': -272.68988037109375, 'logits/chosen': -7.505594730377197, 'logits/rejected': -7.565189838409424, 'epoch': 1.36}
{'loss': 0.137, 'grad_norm': 37.8497314453125, 'learning_rate': 2.145615190234161e-06, 'rewards/chosen': 0.38187652826309204, 'rewards/rejected': -1.3457200527191162, 'rewards/accuracies': 1.0, 'rewards/margins': 1.727596640586853, 'logps/chosen': -260.75457763671875, 'logps/rejected': -306.7587890625, 'logits/chosen': -7.514901638031006, 'logits/rejected': -7.535538673400879, 'epoch': 1.38}
{'loss': 0.7146, 'grad_norm': 644.4657592773438, 'learning_rate': 2.0119999189785775e-06, 'rewards/chosen': 0.4160933792591095, 'rewards/rejected': -1.0971949100494385, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.513288140296936, 'logps/chosen': -287.6762390136719, 'logps/rejected': -286.719970703125, 'logits/chosen': -7.505255699157715, 'logits/rejected': -7.5985426902771, 'epoch': 1.4}
{'loss': 0.2107, 'grad_norm': 34.70798110961914, 'learning_rate': 1.8814942987976126e-06, 'rewards/chosen': 0.5264045596122742, 'rewards/rejected': -1.1835654973983765, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.7099699974060059, 'logps/chosen': -261.1366271972656, 'logps/rejected': -295.7440185546875, 'logits/chosen': -7.4711809158325195, 'logits/rejected': -7.527889251708984, 'epoch': 1.42}
{'loss': 0.1439, 'grad_norm': 21.724519729614258, 'learning_rate': 1.7542573306866071e-06, 'rewards/chosen': 0.2989630699157715, 'rewards/rejected': -1.4935437440872192, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.7925066947937012, 'logps/chosen': -295.67724609375, 'logps/rejected': -308.63916015625, 'logits/chosen': -7.437317848205566, 'logits/rejected': -7.636633396148682, 'epoch': 1.44}
{'loss': 0.2422, 'grad_norm': 33.46957015991211, 'learning_rate': 1.6304440332918525e-06, 'rewards/chosen': 0.3843529224395752, 'rewards/rejected': -1.0628650188446045, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.4472179412841797, 'logps/chosen': -299.87469482421875, 'logps/rejected': -288.5666809082031, 'logits/chosen': -7.584973335266113, 'logits/rejected': -7.559925079345703, 'epoch': 1.47}
{'loss': 0.0847, 'grad_norm': 18.83280372619629, 'learning_rate': 1.5102052540442492e-06, 'rewards/chosen': 0.3328297734260559, 'rewards/rejected': -1.5920755863189697, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.92490553855896, 'logps/chosen': -263.35137939453125, 'logps/rejected': -277.2901916503906, 'logits/chosen': -7.3924970626831055, 'logits/rejected': -7.460292339324951, 'epoch': 1.49}
{'loss': 0.8069, 'grad_norm': 553.8900146484375, 'learning_rate': 1.3936874853749414e-06, 'rewards/chosen': 0.36040493845939636, 'rewards/rejected': -1.5154834985733032, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.8758882284164429, 'logps/chosen': -259.5557556152344, 'logps/rejected': -293.9913330078125, 'logits/chosen': -7.447534084320068, 'logits/rejected': -7.69968318939209, 'epoch': 1.51}
{'loss': 0.1425, 'grad_norm': 71.9974365234375, 'learning_rate': 1.2810326862368722e-06, 'rewards/chosen': 0.15464571118354797, 'rewards/rejected': -1.5840682983398438, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.7387139797210693, 'logps/chosen': -259.1317138671875, 'logps/rejected': -300.7300109863281, 'logits/chosen': -7.4537353515625, 'logits/rejected': -7.577627658843994, 'epoch': 1.53}
{'loss': 0.2791, 'grad_norm': 58.364688873291016, 'learning_rate': 1.1723781091496448e-06, 'rewards/chosen': 0.3694112002849579, 'rewards/rejected': -1.1837037801742554, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.5531150102615356, 'logps/chosen': -253.77127075195312, 'logps/rejected': -276.1656799316406, 'logits/chosen': -7.5585432052612305, 'logits/rejected': -7.553606033325195, 'epoch': 1.56}
{'loss': 0.7459, 'grad_norm': 621.9248657226562, 'learning_rate': 1.06785613297849e-06, 'rewards/chosen': 0.2591441571712494, 'rewards/rejected': -1.153425931930542, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.4125701189041138, 'logps/chosen': -280.2454833984375, 'logps/rejected': -296.6103210449219, 'logits/chosen': -7.583266258239746, 'logits/rejected': -7.5874128341674805, 'epoch': 1.58}
{'loss': 0.707, 'grad_norm': 345.8475646972656, 'learning_rate': 9.675941016509926e-07, 'rewards/chosen': 0.1573217511177063, 'rewards/rejected': -1.1313283443450928, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.2886501550674438, 'logps/chosen': -283.0247802734375, 'logps/rejected': -294.9532775878906, 'logits/chosen': -7.518229961395264, 'logits/rejected': -7.5206732749938965, 'epoch': 1.6}
{'loss': 0.1825, 'grad_norm': 28.04935073852539, 'learning_rate': 8.717141690081449e-07, 'rewards/chosen': 0.33722591400146484, 'rewards/rejected': -1.199710488319397, 'rewards/accuracies': 0.96875, 'rewards/margins': 1.5369365215301514, 'logps/chosen': -270.9004211425781, 'logps/rejected': -266.33123779296875, 'logits/chosen': -7.408995151519775, 'logits/rejected': -7.500418663024902, 'epoch': 1.62}
{'loss': 0.2039, 'grad_norm': 59.46992492675781, 'learning_rate': 7.803331499787001e-07, 'rewards/chosen': 0.14048437774181366, 'rewards/rejected': -1.2923320531845093, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.4328163862228394, 'logps/chosen': -258.53460693359375, 'logps/rejected': -306.9393310546875, 'logits/chosen': -7.542109489440918, 'logits/rejected': -7.531449317932129, 'epoch': 1.64}
{'loss': 0.3039, 'grad_norm': 80.95272827148438, 'learning_rate': 6.935623782581788e-07, 'rewards/chosen': 0.3386107087135315, 'rewards/rejected': -1.0928163528442383, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.4314271211624146, 'logps/chosen': -277.83251953125, 'logps/rejected': -296.82928466796875, 'logits/chosen': -7.556215286254883, 'logits/rejected': -7.556154727935791, 'epoch': 1.67}
{'loss': 0.2656, 'grad_norm': 39.75810241699219, 'learning_rate': 6.115075706659099e-07, 'rewards/chosen': 0.4755368232727051, 'rewards/rejected': -0.9000566601753235, 'rewards/accuracies': 0.8125, 'rewards/margins': 1.375593662261963, 'logps/chosen': -251.71075439453125, 'logps/rejected': -260.6180419921875, 'logits/chosen': -7.44757080078125, 'logits/rejected': -7.569328308105469, 'epoch': 1.69}
{'loss': 1.5164, 'grad_norm': 707.69384765625, 'learning_rate': 5.342686983453707e-07, 'rewards/chosen': 0.20439936220645905, 'rewards/rejected': -1.4268646240234375, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.631264090538025, 'logps/chosen': -273.9686584472656, 'logps/rejected': -304.9524230957031, 'logits/chosen': -7.613405227661133, 'logits/rejected': -7.668887138366699, 'epoch': 1.71}
{'loss': 0.437, 'grad_norm': 210.49517822265625, 'learning_rate': 4.6193986496474824e-07, 'rewards/chosen': 0.28243204951286316, 'rewards/rejected': -1.3901890516281128, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6726211309432983, 'logps/chosen': -283.7689208984375, 'logps/rejected': -301.16094970703125, 'logits/chosen': -7.52781343460083, 'logits/rejected': -7.505039691925049, 'epoch': 1.73}
{'loss': 0.3675, 'grad_norm': 275.23077392578125, 'learning_rate': 3.946091920661109e-07, 'rewards/chosen': 0.13104501366615295, 'rewards/rejected': -1.0153061151504517, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.1463512182235718, 'logps/chosen': -268.31488037109375, 'logps/rejected': -286.4341125488281, 'logits/chosen': -7.461180210113525, 'logits/rejected': -7.492715358734131, 'epoch': 1.76}
{'loss': 2.0098, 'grad_norm': 1240.5684814453125, 'learning_rate': 3.323587117028948e-07, 'rewards/chosen': 0.2410702407360077, 'rewards/rejected': -1.1569846868515015, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.3980547189712524, 'logps/chosen': -279.12359619140625, 'logps/rejected': -314.7678527832031, 'logits/chosen': -7.42469596862793, 'logits/rejected': -7.398695945739746, 'epoch': 1.78}
{'loss': 0.1742, 'grad_norm': 84.70120239257812, 'learning_rate': 2.752642664964683e-07, 'rewards/chosen': 0.4505717158317566, 'rewards/rejected': -1.339448094367981, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.7900197505950928, 'logps/chosen': -245.4839324951172, 'logps/rejected': -284.4859924316406, 'logits/chosen': -7.544198036193848, 'logits/rejected': -7.630263805389404, 'epoch': 1.8}
{'loss': 0.5042, 'grad_norm': 232.71029663085938, 'learning_rate': 2.2339541723359112e-07, 'rewards/chosen': 0.16926485300064087, 'rewards/rejected': -1.1720186471939087, 'rewards/accuracies': 0.875, 'rewards/margins': 1.3412833213806152, 'logps/chosen': -236.7916717529297, 'logps/rejected': -262.75347900390625, 'logits/chosen': -7.463499069213867, 'logits/rejected': -7.562782287597656, 'epoch': 1.82}
{'loss': 0.2045, 'grad_norm': 27.243202209472656, 'learning_rate': 1.768153581173062e-07, 'rewards/chosen': 0.3171883523464203, 'rewards/rejected': -1.2691786289215088, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.586366891860962, 'logps/chosen': -296.9946594238281, 'logps/rejected': -278.13616943359375, 'logits/chosen': -7.44697380065918, 'logits/rejected': -7.594425201416016, 'epoch': 1.85}
{'loss': 0.1226, 'grad_norm': 55.31736373901367, 'learning_rate': 1.3558083977453931e-07, 'rewards/chosen': 0.3758753836154938, 'rewards/rejected': -1.4444100856781006, 'rewards/accuracies': 0.9375, 'rewards/margins': 1.820285439491272, 'logps/chosen': -288.7054748535156, 'logps/rejected': -288.05487060546875, 'logits/chosen': -7.507302284240723, 'logits/rejected': -7.70082950592041, 'epoch': 1.87}
{'loss': 0.2619, 'grad_norm': 90.49726867675781, 'learning_rate': 9.974210011419971e-08, 'rewards/chosen': 0.4598659574985504, 'rewards/rejected': -1.276650309562683, 'rewards/accuracies': 0.90625, 'rewards/margins': 1.7365163564682007, 'logps/chosen': -252.91351318359375, 'logps/rejected': -257.0963439941406, 'logits/chosen': -7.629580497741699, 'logits/rejected': -7.60186767578125, 'epoch': 1.89}
{'loss': 0.5099, 'grad_norm': 383.4124755859375, 'learning_rate': 6.934280312002984e-08, 'rewards/chosen': 0.18786802887916565, 'rewards/rejected': -1.3732109069824219, 'rewards/accuracies': 0.84375, 'rewards/margins': 1.5610787868499756, 'logps/chosen': -294.7166748046875, 'logps/rejected': -301.6400146484375, 'logits/chosen': -7.503688335418701, 'logits/rejected': -7.665785789489746, 'epoch': 1.91}
{'loss': 0.3234, 'grad_norm': 39.99541473388672, 'learning_rate': 4.441998565276293e-08, 'rewards/chosen': 0.2655464708805084, 'rewards/rejected': -0.8156484365463257, 'rewards/accuracies': 0.78125, 'rewards/margins': 1.0811947584152222, 'logps/chosen': -262.300537109375, 'logps/rejected': -227.99136352539062, 'logits/chosen': -7.534447193145752, 'logits/rejected': -7.7155351638793945, 'epoch': 1.93}
{'loss': 0.5393, 'grad_norm': 395.6192626953125, 'learning_rate': 2.500401232641875e-08, 'rewards/chosen': 0.3079492449760437, 'rewards/rejected': -1.2697516679763794, 'rewards/accuracies': 0.875, 'rewards/margins': 1.5777007341384888, 'logps/chosen': -276.8864440917969, 'logps/rejected': -304.4053039550781, 'logits/chosen': -7.724278926849365, 'logits/rejected': -7.577877044677734, 'epoch': 1.96}
{'loss': 0.2625, 'grad_norm': 311.3809814453125, 'learning_rate': 1.1118538513692796e-08, 'rewards/chosen': 0.055580779910087585, 'rewards/rejected': -1.6034350395202637, 'rewards/accuracies': 0.875, 'rewards/margins': 1.6590158939361572, 'logps/chosen': -256.2379455566406, 'logps/rejected': -316.93194580078125, 'logits/chosen': -7.720415115356445, 'logits/rejected': -7.501685619354248, 'epoch': 1.98}
{'loss': 0.5724, 'grad_norm': 110.67638397216797, 'learning_rate': 2.7804815255326245e-09, 'rewards/chosen': 0.3072693347930908, 'rewards/rejected': -1.0500088930130005, 'rewards/accuracies': 0.8709677457809448, 'rewards/margins': 1.3572782278060913, 'logps/chosen': -303.0121154785156, 'logps/rejected': -261.2689514160156, 'logits/chosen': -7.5006279945373535, 'logits/rejected': -7.605625629425049, 'epoch': 2.0}
{'train_runtime': 1868.9297, 'train_samples_per_second': 1.54, 'train_steps_per_second': 0.048, 'train_loss': 0.5344096969399187, 'epoch': 2.0}
Unloading and merging model: 100%|██████████| 632/632 [00:00<00:00, 6587.70it/s]
